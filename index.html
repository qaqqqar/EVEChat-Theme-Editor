<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>EVEChat主题编辑器</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/remixicon@3.5.0/fonts/remixicon.css" rel="stylesheet">
    <script src="https://code.iconify.design/3/3.1.0/iconify.min.js"></script>
    <link rel="stylesheet" href="index.css">
</head>
<body>
<!-- 自定义弹窗 -->
<div class="custom-alert-overlay" id="customAlertOverlay" onclick="closeCustomAlert(event)">
    <div class="custom-alert-box" onclick="event.stopPropagation()">
        <div class="custom-alert-icon" id="customAlertIcon">✓</div>
        <div class="custom-alert-title" id="customAlertTitle">提示</div>
        <div class="custom-alert-message" id="customAlertMessage">操作成功</div>
        <button class="custom-alert-btn" onclick="closeCustomAlert()">确定</button>
    </div>
</div>
<!-- 挂载位置选择弹窗 -->
<div class="custom-alert-overlay" id="positionSelectModal" onclick="closePositionModal(event)">
    <div class="custom-alert-box" onclick="event.stopPropagation()" style="max-width: 280px;">
        <div class="custom-alert-title" style="margin-bottom: 16px;">选择挂载位置</div>
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <button class="position-select-btn" onclick="confirmAddDecoration('before')">
                <span style="font-weight: 600;">::before</span>
                <span style="font-size: 12px; color: var(--text-muted);">（底层，在头像下方）</span>
            </button>
            <button class="position-select-btn" onclick="confirmAddDecoration('after')">
                <span style="font-weight: 600;">::after</span>
                <span style="font-size: 12px; color: var(--text-muted);">（顶层，在头像上方）</span>
            </button>
        </div>
        <button class="custom-alert-btn" onclick="closePositionModal()" style="margin-top: 16px; background: var(--bg-gray); color: var(--text-secondary);">取消</button>
    </div>
</div>
<!-- 头像框挂载位置选择弹窗 -->
<div class="custom-alert-overlay" id="framePositionModal" onclick="closeFramePositionModal(event)">
    <div class="custom-alert-box" onclick="event.stopPropagation()" style="max-width: 280px;">
        <div class="custom-alert-title" style="margin-bottom: 16px;">选择头像框挂载位置</div>
        <div style="display: flex; flex-direction: column; gap: 10px;">
            <button class="position-select-btn" onclick="setFramePosition('before')">
                <span style="font-weight: 600;">::before</span>
                <span style="font-size: 12px; color: var(--text-muted);">（底层，在头像下方）</span>
            </button>
            <button class="position-select-btn" onclick="setFramePosition('after')">
                <span style="font-weight: 600;">::after</span>
                <span style="font-size: 12px; color: var(--text-muted);">（顶层，在头像上方）</span>
            </button>
        </div>
        <button class="custom-alert-btn" onclick="closeFramePositionModal()" style="margin-top: 16px; background: var(--bg-gray); color: var(--text-secondary);">取消</button>
    </div>
</div>
<!-- 气泡装饰挂载位置弹窗 -->

    <!-- 图片预览模态框 -->
    <div class="image-preview-modal" id="imagePreviewModal" onclick="closeImagePreview()">
        <img id="previewImage" src="" alt="预览图片">
    </div>

       <!-- 使用须知弹窗 -->
    <div class="modal-overlay" id="helpModal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    使用须知
                </div>
                <button class="modal-close" onclick="closeHelpModal()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="18" y1="6" x2="6" y2="18"/>
                        <line x1="6" y1="6" x2="18" y2="18"/>
                    </svg>
                </button>
            </div>
            <div class="modal-body">
                <div class="notice-section">
                    <div class="notice-highlight" style="white-space: pre-wrap; font-size: 13px; line-height: 1.6;">欢迎使用EVEChat主题编辑器！
作者：qaq
非常感谢我的好朋友们对此编辑器的支持和建议以及测试！
禁止抄袭、二改、模仿别的老师的代码。

导出的代码请不要删掉第一行注释。

一些小问题——
加密之后应用不了：请降低加密程度或者不使用加密。
导出的代码出现奇怪的问题：请把代码交给AI进行肘击。
切换回来发现突然白屏：请点击其他模块再点击回来即可。
某个操作没有反应：试试滑动其他的滑块。如果反复多次还是不行，大概就是bug了，我将肘击。</div>
                </div>
                <div style="display: flex; gap: 10px; margin-top: 16px; justify-content: flex-end;">
                    <button class="editor-btn" onclick="dismissHelpModalForever()">不再提示</button>
                    <button class="editor-btn primary" onclick="closeHelpModal()">确定</button>
                </div>
            </div>
        </div>
    </div>

    <div class="editor-container">
        <!-- 顶部标题栏 -->
        <div class="editor-header" id="editorHeader">
            <div class="editor-title">
                
                
                EVEChat主题编辑器
            </div>
            <div class="header-actions">
                <button class="expand-btn" onclick="toggleFullscreen()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="15 3 21 3 21 9"/>
                        <polyline points="9 21 3 21 3 15"/>
                        <line x1="21" y1="3" x2="14" y2="10"/>
                        <line x1="3" y1="21" x2="10" y2="14"/>
                    </svg>
                    展开预览
                </button>
                <button class="help-btn" onclick="openHelpModal()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="12" cy="12" r="10"/>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
                        <line x1="12" y1="17" x2="12.01" y2="17"/>
                    </svg>
                    使用须知
                </button>
            </div>
        </div>

        <!-- 预览区域 -->
        <div class="preview-section" id="previewSection">
            <button class="fullscreen-exit-btn" onclick="toggleFullscreen()">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="4 14 10 14 10 20"/>
                    <polyline points="20 10 14 10 14 4"/>
                    <line x1="14" y1="10" x2="21" y2="3"/>
                    <line x1="3" y1="21" x2="10" y2="14"/>
                </svg>
                退出全屏
            </button>

            <div class="preview-frame">
                <div class="preview-header">
                    <div class="preview-header-left">
                        <button class="preview-back-btn">
                            <span class="preview-back-btn-bracket">‹</span>
                        </button>
                    </div>
                    <div class="preview-header-title">EVEChat主题编辑器</div>
                    <div class="preview-header-right">
                        <button class="preview-header-btn"><i class="ri-door-open-fill"></i></button>
                        <button class="preview-header-btn"><i class="fa-solid fa-ellipsis-vertical"></i></button>
                    </div>
                </div>

                <div class="preview-messages" id="previewMessages"></div>

                <!-- 工具面板 -->
<div class="preview-tools-panel" id="previewToolsPanel">
    <div class="preview-tools-grid" id="previewToolsGrid"></div>
</div>

<div class="preview-input-bar">
    <div class="preview-add-btn" id="previewAddBtn">+</div>
    <input type="text" class="preview-input-field" placeholder="输入消息...">
    <div class="preview-continue-btn"><i class="fa-solid fa-comment-dots"></i></div>
    <button class="preview-send-btn">发送</button>
</div>
            </div>
        </div>

        <!-- 大Tab区域 -->
        <div class="main-tabs" id="mainTabs">
    <div class="main-tab active" data-tab="preview">整体预览</div>
    <div class="main-tab" data-tab="overall">整体布局</div>
    <div class="main-tab" data-tab="received">对方布局</div>
    <div class="main-tab" data-tab="sent">我方布局</div>
    <!-- 新增 -->
    <div class="main-tab" data-tab="export">导出&加密</div>
</div>

        <!-- 小Tab区域 -->
        <div class="sub-tabs hidden" id="subTabs">
    <div class="sub-tab active" data-subtab="avatar">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
        头像
    </div>
    <div class="sub-tab" data-subtab="bubble">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
        气泡设置
    </div>
    <div class="sub-tab" data-subtab="reply">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 17 4 12 9 7"/><path d="M20 18v-2a4 4 0 0 0-4-4H4"/></svg>
        引用
    </div>
    <div class="sub-tab" data-subtab="transfer">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
        转账
    </div>
    <div class="sub-tab" data-subtab="system">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
        系统
    </div>
    <div class="sub-tab" data-subtab="toolbar">
    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/></svg>
    工具栏
</div>
<div class="sub-tab" data-subtab="chatarea">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><path d="M3 9h18"/><path d="M3 15h18"/></svg>
        聊天区域
    </div>
    <div class="sub-tab" data-subtab="topbar">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
        顶栏
    </div>
    <div class="sub-tab" data-subtab="bottombar">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="16" width="20" height="6" rx="2"/><path d="M12 16v-6"/><path d="M9 13l3-3 3 3"/></svg>
        底栏
    </div>
    <!-- === 新增结束 === -->
</div>
<!-- 导出&加密的小Tab -->
<div class="sub-tabs hidden" id="exportSubTabs">
    <div class="sub-tab active" data-subtab="export">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
        导出
    </div>
    <div class="sub-tab" data-subtab="encrypt">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
        加密
    </div>
</div>
<!-- 撤回/恢复按钮 -->
<div class="undo-redo-bar" id="undoRedoBar">
    <button class="ur-btn" id="undoBtn" onclick="undoAction()" disabled>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="1 4 1 10 7 10"/><path d="M3.51 15a9 9 0 1 0 2.13-9.36L1 10"/></svg>
        撤回
    </button>
    <button class="ur-btn" id="redoBtn" onclick="redoAction()" disabled>
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="23 4 23 10 17 10"/><path d="M20.49 15a9 9 0 1 1-2.12-9.36L23 10"/></svg>
        恢复
    </button>
</div>
        <!-- 编辑区域 -->
        <div class="editor-section" id="editorSection">
            <div class="editor-content" id="content-preview">
                <div class="editor-group">
                    <div class="editor-group-title">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                            <circle cx="12" cy="12" r="3"/>
                        </svg>
                        整体预览
                    </div>
                    <p style="font-size: 13px; color: var(--text-secondary); line-height: 1.6;">
                        上方预览区展示了所有类型的消息样式。
                    </p>
                </div>
            </div>

            <div class="editor-content hidden" id="content-overall-avatar">
    <div class="editor-group">
        
        <!-- 头像显示 折叠栏 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/><circle cx="12" cy="12" r="3"/></svg>
                    头像显示
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">显示模式</span>
                    <select class="editor-select" id="avatar-display-mode" onchange="updateAvatarDisplayMode(this.value)">
                        <option value="all">全部显示</option>
                        <option value="none">全部隐藏</option>
                        <option value="first">仅首条显示</option>
                        <option value="last">仅末条显示</option>
                    </select>
                </div>
                <p style="font-size: 11px; color: var(--text-muted); margin-top: 8px;">
                    控制同一回合内连续消息的头像显示方式
                </p>
            </div>
        </div>
        
        <!-- 头像来源 折叠栏 -->
<div class="collapse-section">
    <div class="collapse-header" onclick="toggleCollapse(this)">
        <span class="collapse-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="8" r="4"/><path d="M20 21a8 8 0 1 0-16 0"/></svg>
            头像来源
        </span>
        <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="collapse-body">
        <div class="editor-switch-row">
            <span class="editor-label">自动获取平台头像</span>
            <label class="editor-switch">
                <input type="checkbox" id="avatar-auto-fetch" onchange="toggleAvatarAutoFetch()">
                <span class="editor-switch-slider"></span>
            </label>
        </div>
        <div id="avatar-manual-section">
            <div class="editor-row">
                <span class="editor-label">头像URL</span>
                <input type="text" class="editor-input" id="avatar-url" placeholder="输入自定义头像URL" onchange="updatePreview()">
            </div>
            <div class="editor-row">
                <span class="editor-label">上传头像</span>
                <input type="file" class="editor-input" accept="image/*" onchange="handleAvatarUpload(this)">
            </div>
        </div>
    </div>
</div>
        
        <!-- 头像装饰 折叠栏 -->
<div class="collapse-section">
    <div class="collapse-header" onclick="toggleCollapse(this)">
        <span class="collapse-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="12" cy="12" r="4"/></svg>
            头像装饰
        </span>
        <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="collapse-body">
        <!-- 头像框 -->
        <div class="editor-row">
            <span class="editor-label">头像框URL</span>
            <input type="text" class="editor-input" id="avatar-frame-url" placeholder="输入头像框图片URL" onchange="styleConfig.avatar.frameUrl = this.value; updatePreview()">
        </div>
        <div class="editor-row">
            <span class="editor-label">上传头像框</span>
            <input type="file" class="editor-input" accept="image/*" onchange="handleFrameUpload(this)">
        </div>
        <div class="editor-row">
            <span class="editor-label">挂载位置</span>
            <button class="editor-btn" onclick="openFramePositionModal()" style="flex: 1; justify-content: center;">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 14px; height: 14px;"><path d="M12 3v18M3 12h18"/></svg>
                <span id="frame-position-text">::after（顶层）</span>
            </button>
        </div>
        
        <div style="height: 1px; background: var(--border-color); margin: 16px 0;"></div>
        
        <!-- 文字装饰列表 -->
        <div class="decoration-list" id="decorationList">
            <!-- 装饰项会动态生成 -->
        </div>
        <button class="add-decoration-btn" onclick="openAddDecorationModal()">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
            添加文字装饰
        </button>
    </div>
</div>
        
        <!-- 头像样式 折叠栏 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/></svg>
                    头像样式
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">大小</span>
                    <input type="range" class="editor-slider" id="avatar-size-slider" min="24" max="80" value="40" oninput="updateAvatarSize(this.value)">
                    <input type="number" class="editor-input" id="avatar-size-input" value="40" min="24" max="80" style="width: 60px;" oninput="updateAvatarSize(this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">圆角</span>
                    <input type="range" class="editor-slider" id="avatar-radius-slider" min="0" max="50" value="50" oninput="updateAvatarRadius(this.value)">
                    <input type="number" class="editor-input" id="avatar-radius-input" value="50" min="0" max="50" style="width: 60px;" oninput="updateAvatarRadius(this.value)"> %
                </div>
            </div>
        </div>
        
        <!-- 头像位置 折叠栏 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M5 9l-3 3 3 3"/><path d="M9 5l3-3 3 3"/><path d="M15 19l3 3 3-3"/><path d="M19 9l3 3-3 3"/><line x1="2" y1="12" x2="22" y2="12"/><line x1="12" y1="2" x2="12" y2="22"/></svg>
                    头像位置
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">X偏移</span>
                    <input type="range" class="editor-slider" id="avatar-pos-x-slider" min="-100" max="100" value="0" oninput="updateAvatarPosition('x', this.value)">
                    <input type="number" class="editor-input" id="avatar-pos-x-input" value="0" style="width: 60px;" oninput="updateAvatarPosition('x', this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y偏移</span>
                    <input type="range" class="editor-slider" id="avatar-pos-y-slider" min="-100" max="100" value="0" oninput="updateAvatarPosition('y', this.value)">
                    <input type="number" class="editor-input" id="avatar-pos-y-input" value="0" style="width: 60px;" oninput="updateAvatarPosition('y', this.value)"> px
                </div>
            </div>
        </div>
        
        <!-- 头像阴影 折叠栏 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2M4.22 19.78l1.42-1.42M18.36 5.64l1.42-1.42"/></svg>
                    头像阴影
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-switch-row">
                    <span class="editor-label">启用阴影</span>
                    <label class="editor-switch">
                        <input type="checkbox" id="avatar-shadow-enable" checked onchange="updateAvatarShadow()">
                        <span class="editor-switch-slider"></span>
                    </label>
                </div>
                
                <div class="editor-row">
                    <span class="editor-label">阴影类型</span>
                    <select class="editor-select" id="avatar-shadow-type" onchange="toggleShadowType()">
                        <option value="solid">纯色阴影</option>
                        <option value="gradient">渐变阴影</option>
                    </select>
                </div>
                
                <!-- 纯色阴影设置 -->
                <div id="shadow-solid-section">
                    <div class="editor-row">
                        <span class="editor-label">阴影颜色</span>
                        <div class="editor-color-row">
                            <input type="color" class="editor-color-input" id="avatar-shadow-color" value="#000000" onchange="updateAvatarShadow()">
                            <input type="text" class="editor-color-text" id="avatar-shadow-color-text" value="#000000" onchange="syncShadowColor(this.value)">
                        </div>
                    </div>
                    <div class="editor-row">
                        <span class="editor-label">透明度</span>
                        <input type="range" class="editor-slider" id="avatar-shadow-opacity" min="0" max="100" value="20" oninput="updateAvatarShadow()">
                        <span id="avatar-shadow-opacity-value" style="min-width: 40px; text-align: right;">20%</span>
                    </div>
                </div>
                
                <!-- 渐变阴影设置 -->
                <div id="shadow-gradient-section" style="display: none;">
                    <div class="editor-row">
                        <span class="editor-label">渐变方向</span>
                        <select class="editor-select" id="avatar-shadow-direction" onchange="updateAvatarShadow()">
                            <option value="to right">→ 向右</option>
                            <option value="to left">← 向左</option>
                            <option value="to bottom">↓ 向下</option>
                            <option value="to top">↑ 向上</option>
                            <option value="to bottom right">↘ 右下</option>
                            <option value="to bottom left">↙ 左下</option>
                            <option value="to top right">↗ 右上</option>
                            <option value="to top left">↖ 左上</option>
                            <option value="circle">◎ 径向</option>
                        </select>
                    </div>
                    <div class="editor-row" style="flex-direction: column; align-items: stretch;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <span class="editor-label">渐变颜色</span>
                            <button class="editor-btn" onclick="addShadowGradientColor()" style="padding: 4px 8px;">
                                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width: 12px; height: 12px;"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                                添加
                            </button>
                        </div>
                        <div id="shadow-gradient-colors" class="gradient-color-list"></div>
                    </div>
                    <div class="editor-row">
                        <span class="editor-label">预览</span>
                        <div id="shadow-gradient-preview" style="flex: 1; height: 24px; border-radius: 4px; border: 1px solid var(--border-color);"></div>
                    </div>
                </div>
                
                <!-- 阴影位置 -->
                <div class="editor-row">
                    <span class="editor-label">X偏移</span>
                    <input type="range" class="editor-slider" id="avatar-shadow-x" min="-20" max="20" value="0" oninput="updateAvatarShadow()">
                    <input type="number" class="editor-input" id="avatar-shadow-x-input" value="0" style="width: 50px;" oninput="syncShadowX(this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y偏移</span>
                    <input type="range" class="editor-slider" id="avatar-shadow-y" min="-20" max="20" value="2" oninput="updateAvatarShadow()">
                    <input type="number" class="editor-input" id="avatar-shadow-y-input" value="2" style="width: 50px;" oninput="syncShadowY(this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">模糊半径</span>
                    <input type="range" class="editor-slider" id="avatar-shadow-blur" min="0" max="30" value="4" oninput="updateAvatarShadow()">
                    <input type="number" class="editor-input" id="avatar-shadow-blur-input" value="4" style="width: 50px;" oninput="syncShadowBlur(this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">扩展半径</span>
                    <input type="range" class="editor-slider" id="avatar-shadow-spread" min="-10" max="20" value="0" oninput="updateAvatarShadow()">
                    <input type="number" class="editor-input" id="avatar-shadow-spread-input" value="0" style="width: 50px;" oninput="syncShadowSpread(this.value)"> px
                </div>
            </div>
        </div>
        
    </div>
</div>

  <!-- =============== 气泡设置（整体） =============== -->
<div class="editor-content hidden" id="content-overall-bubble">
    <div class="editor-group">

        <!-- ====== 字体设置 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7V4h16v3"/><path d="M9 20h6"/><path d="M12 4v16"/></svg>
                    字体设置
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">字体大小</span>
                    <input type="range" class="editor-slider" id="font-size-slider" min="12" max="72" value="15"
                           oninput="updateBubbleConfig('fontSize', this.value); document.getElementById('font-size-input').value=this.value">
                    <input type="number" class="editor-input" id="font-size-input" value="15" min="12" max="72" style="width:60px;"
                           oninput="updateBubbleConfig('fontSize', this.value); document.getElementById('font-size-slider').value=this.value"> px
                </div>

                <div class="editor-row">
    <span class="editor-label">字体URL</span>
    <input type="text" class="editor-input" id="font-url" placeholder="输入字体文件URL (woff2/ttf等)"
           onchange="applyFontFromUrl(this.value)">
</div>

                <div class="editor-row">
                    <span class="editor-label">上传字体</span>
                    <input type="file" class="editor-input" accept=".woff,.woff2,.ttf,.otf" onchange="handleFontUpload(this)">
                </div>

                <!-- 字体颜色 - 使用通用颜色组件 -->
                <div id="font-color-picker"></div>
                

<!-- 我方字体颜色 -->
<div id="font-color-sent-picker"></div>

<!-- 文字背景 -->
<div style="border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 12px;">
    <div class="editor-switch-row">
        <span style="font-size: 12px; font-weight: 500;">文字区域背景</span>
        <label class="editor-switch">
            <input type="checkbox" id="text-bg-enable" onchange="toggleTextBg(this.checked)">
            <span class="editor-switch-slider"></span>
        </label>
    </div>
    <div id="text-bg-settings" style="display: none;">
        <div id="text-bg-color-picker"></div>
        <!-- 
  找到 text-bg-settings 里面的 text-bg-color-picker 那一块，
  在它下面（text-bg-url 输入框之前）插入以下径向渐变高级控制面板
-->

<!-- ★★★ 在 <div id="text-bg-settings"> 内部，<div id="text-bg-color-picker"></div> 之后插入 ★★★ -->

<div id="text-bg-radial-settings" style="display:none; border:1px solid var(--border-color); border-radius:8px; padding:12px; margin-bottom:12px;">
    <span style="font-size:12px; font-weight:500; display:block; margin-bottom:10px;">径向渐变高级设置</span>
    
    <div class="editor-row">
        <span class="editor-label">形状</span>
        <select class="editor-select" id="text-bg-radial-shape" onchange="updateTextBgRadialConfig()">
            <option value="circle">圆形 (circle)</option>
            <option value="ellipse" selected>椭圆 (ellipse)</option>
        </select>
    </div>
    
    <div id="text-bg-ellipse-size">
        <div class="editor-row">
            <span class="editor-label">水平半径</span>
            <input type="range" class="editor-slider" id="text-bg-radial-rx" min="10" max="200" value="60"
                   oninput="updateTextBgRadialConfig(); this.nextElementSibling.value=this.value">
            <input type="number" class="editor-input" value="60" style="width:55px;"
                   oninput="updateTextBgRadialConfig(); document.getElementById('text-bg-radial-rx').value=this.value"> %
        </div>
        <div class="editor-row">
            <span class="editor-label">垂直半径</span>
            <input type="range" class="editor-slider" id="text-bg-radial-ry" min="10" max="200" value="45"
                   oninput="updateTextBgRadialConfig(); this.nextElementSibling.value=this.value">
            <input type="number" class="editor-input" value="45" style="width:55px;"
                   oninput="updateTextBgRadialConfig(); document.getElementById('text-bg-radial-ry').value=this.value"> %
        </div>
    </div>
    
    <div class="editor-row">
        <span class="editor-label">中心X</span>
        <input type="range" class="editor-slider" id="text-bg-radial-cx" min="0" max="100" value="50"
               oninput="updateTextBgRadialConfig(); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="50" style="width:55px;"
               oninput="updateTextBgRadialConfig(); document.getElementById('text-bg-radial-cx').value=this.value"> %
    </div>
    <div class="editor-row">
        <span class="editor-label">中心Y</span>
        <input type="range" class="editor-slider" id="text-bg-radial-cy" min="0" max="100" value="50"
               oninput="updateTextBgRadialConfig(); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="50" style="width:55px;"
               oninput="updateTextBgRadialConfig(); document.getElementById('text-bg-radial-cy').value=this.value"> %
    </div>
    
    <div class="editor-row" style="margin-top:8px;">
        <span class="editor-label">预览</span>
        <div id="text-bg-radial-preview" style="flex:1; height:40px; border-radius:8px; border:1px solid var(--border-color);"></div>
    </div>
</div>
<!-- ★★★ 文字背景尺寸与边缘模糊控制 ★★★ -->
<div style="border:1px solid var(--border-color); border-radius:8px; padding:12px; margin-bottom:12px;">
    <span style="font-size:12px; font-weight:500; display:block; margin-bottom:10px;">背景尺寸与位置</span>
    
    <div class="editor-row">
        <span class="editor-label">宽度</span>
        <input type="range" class="editor-slider" id="text-bg-width" min="0" max="500" value="0"
               oninput="bubbleConfig.textBgWidth=parseInt(this.value); this.nextElementSibling.value=this.value; updatePreview()">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="bubbleConfig.textBgWidth=parseInt(this.value); document.getElementById('text-bg-width').value=this.value; updatePreview()"> px
    </div>
    <p style="font-size:10px; color:var(--text-muted); margin:-6px 0 8px 82px;">0 = 自适应文字宽度</p>
    
    <div class="editor-row">
        <span class="editor-label">高度</span>
        <input type="range" class="editor-slider" id="text-bg-height" min="0" max="300" value="0"
               oninput="bubbleConfig.textBgHeight=parseInt(this.value); this.nextElementSibling.value=this.value; updatePreview()">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="bubbleConfig.textBgHeight=parseInt(this.value); document.getElementById('text-bg-height').value=this.value; updatePreview()"> px
    </div>
    <p style="font-size:10px; color:var(--text-muted); margin:-6px 0 8px 82px;">0 = 自适应文字高度</p>
    
    <div class="editor-row">
        <span class="editor-label">X偏移</span>
        <input type="range" class="editor-slider" id="text-bg-offset-x" min="-100" max="100" value="0"
               oninput="bubbleConfig.textBgOffsetX=parseInt(this.value); this.nextElementSibling.value=this.value; updatePreview()">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="bubbleConfig.textBgOffsetX=parseInt(this.value); document.getElementById('text-bg-offset-x').value=this.value; updatePreview()"> px
    </div>
    
    <div class="editor-row">
        <span class="editor-label">Y偏移</span>
        <input type="range" class="editor-slider" id="text-bg-offset-y" min="-100" max="100" value="0"
               oninput="bubbleConfig.textBgOffsetY=parseInt(this.value); this.nextElementSibling.value=this.value; updatePreview()">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="bubbleConfig.textBgOffsetY=parseInt(this.value); document.getElementById('text-bg-offset-y').value=this.value; updatePreview()"> px
    </div>
    
    <div class="editor-row">
        <span class="editor-label">边缘模糊</span>
        <input type="range" class="editor-slider" id="text-bg-blur" min="0" max="50" value="0"
               oninput="bubbleConfig.textBgBlur=parseInt(this.value); this.nextElementSibling.value=this.value; updatePreview()">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="bubbleConfig.textBgBlur=parseInt(this.value); document.getElementById('text-bg-blur').value=this.value; updatePreview()"> px
    </div>
</div>
        <div class="editor-row">
            <span class="editor-label">背景图URL</span>
            <input type="text" class="editor-input" id="text-bg-url" placeholder="文字背景图URL"
                   onchange="bubbleConfig.textBgUrl=this.value; updatePreview()">
        </div>
        <div class="editor-row">
            <span class="editor-label">上传背景</span>
            <input type="file" class="editor-input" accept="image/*" onchange="handleTextBgUpload(this)">
        </div>
        <!-- ★★★ 新增：四角圆角控制 ★★★ -->
    <div class="four-sides-control">
        <div class="four-sides-header">
            <span>背景圆角</span>
            <label class="four-sides-mode-toggle">
                <input type="checkbox" id="textBgRadius-unified" checked
                       onchange="toggleTextBgRadiusMode(this.checked)">
                统一控制
            </label>
        </div>
        <div class="four-sides-uniform" id="textBgRadius-uniform">
            <div class="editor-row">
                <span class="editor-label">全部</span>
                <input type="range" class="editor-slider" id="tbr-all-slider" min="0" max="50" value="0"
                       oninput="updateTextBgRadiusUniform(this.value)">
                <input type="number" class="editor-input" id="tbr-all-input" value="0" style="width:55px;"
                       oninput="updateTextBgRadiusUniform(this.value)"> px
            </div>
        </div>
        <div class="four-sides-individual" id="textBgRadius-individual">
            <div class="editor-row">
                <span class="editor-label">左上</span>
                <input type="range" class="editor-slider" min="0" max="50" value="0"
                       oninput="updateTextBgRadiusSide('tl',this.value)">
                <input type="number" class="editor-input" id="tbr-tl" value="0" style="width:55px;"
                       oninput="updateTextBgRadiusSide('tl',this.value)"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">右上</span>
                <input type="range" class="editor-slider" min="0" max="50" value="0"
                       oninput="updateTextBgRadiusSide('tr',this.value)">
                <input type="number" class="editor-input" id="tbr-tr" value="0" style="width:55px;"
                       oninput="updateTextBgRadiusSide('tr',this.value)"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">右下</span>
                <input type="range" class="editor-slider" min="0" max="50" value="0"
                       oninput="updateTextBgRadiusSide('br',this.value)">
                <input type="number" class="editor-input" id="tbr-br" value="0" style="width:55px;"
                       oninput="updateTextBgRadiusSide('br',this.value)"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">左下</span>
                <input type="range" class="editor-slider" min="0" max="50" value="0"
                       oninput="updateTextBgRadiusSide('bl',this.value)">
                <input type="number" class="editor-input" id="tbr-bl" value="0" style="width:55px;"
                       oninput="updateTextBgRadiusSide('bl',this.value)"> px
            </div>
        </div>
    </div>
    </div>
</div>
            </div>
        </div>

        <!-- ====== 气泡外观 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/></svg>
                    气泡外观
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">

                <!-- 圆角 -->
                <div class="four-sides-control">
                    <div class="four-sides-header">
                        <span>圆角</span>
                        <label class="four-sides-mode-toggle">
                            <input type="checkbox" id="border-radius-unified" checked
                                   onchange="toggleFourSidesMode('borderRadius', this.checked)">
                            统一控制
                        </label>
                    </div>
                    <div class="four-sides-uniform" id="borderRadius-uniform">
                        <div class="editor-row">
                            <span class="editor-label">全部</span>
                            <input type="range" class="editor-slider" id="br-all-slider" min="0" max="50" value="18"
                                   oninput="updateFourSidesUniform('borderRadius', this.value)">
                            <input type="number" class="editor-input" id="br-all-input" value="18" style="width:55px;"
                                   oninput="updateFourSidesUniform('borderRadius', this.value)"> px
                        </div>
                    </div>
                    <div class="four-sides-individual" id="borderRadius-individual">
                        <div class="editor-row">
                            <span class="editor-label">左上</span>
                            <input type="range" class="editor-slider" min="0" max="50" value="18"
                                   oninput="updateFourSides('borderRadius','tl',this.value)">
                            <input type="number" class="editor-input" id="br-tl" value="18" style="width:55px;"
                                   oninput="updateFourSides('borderRadius','tl',this.value)"> px
                        </div>
                        <div class="editor-row">
                            <span class="editor-label">右上</span>
                            <input type="range" class="editor-slider" min="0" max="50" value="18"
                                   oninput="updateFourSides('borderRadius','tr',this.value)">
                            <input type="number" class="editor-input" id="br-tr" value="18" style="width:55px;"
                                   oninput="updateFourSides('borderRadius','tr',this.value)"> px
                        </div>
                        <div class="editor-row">
                            <span class="editor-label">右下</span>
                            <input type="range" class="editor-slider" min="0" max="50" value="18"
                                   oninput="updateFourSides('borderRadius','br',this.value)">
                            <input type="number" class="editor-input" id="br-br" value="18" style="width:55px;"
                                   oninput="updateFourSides('borderRadius','br',this.value)"> px
                        </div>
                        <div class="editor-row">
                            <span class="editor-label">左下</span>
                            <input type="range" class="editor-slider" min="0" max="50" value="18"
                                   oninput="updateFourSides('borderRadius','bl',this.value)">
                            <input type="number" class="editor-input" id="br-bl" value="18" style="width:55px;"
                                   oninput="updateFourSides('borderRadius','bl',this.value)"> px
                        </div>
                    </div>
                </div>

                <!-- 内边距 -->
                <div class="four-sides-control">
                    <div class="four-sides-header">
                        <span>内边距</span>
                        <label class="four-sides-mode-toggle">
                            <input type="checkbox" id="padding-unified" checked
                                   onchange="toggleFourSidesMode('padding', this.checked)">
                            统一控制
                        </label>
                    </div>
                    <div class="four-sides-uniform" id="padding-uniform">
                        <div class="editor-row">
                            <span class="editor-label">全部</span>
                            <input type="range" class="editor-slider" id="pad-all-slider" min="0" max="30" value="10"
                                   oninput="updateFourSidesUniform('padding', this.value)">
                            <input type="number" class="editor-input" id="pad-all-input" value="10" style="width:55px;"
                                   oninput="updateFourSidesUniform('padding', this.value)"> px
                        </div>
                    </div>
                    <div class="four-sides-individual" id="padding-individual">
                        <div class="editor-row"><span class="editor-label">上</span><input type="range" class="editor-slider" min="0" max="30" value="8" oninput="updateFourSides('padding','t',this.value)"><input type="number" class="editor-input" id="pad-t" value="8" style="width:55px;" oninput="updateFourSides('padding','t',this.value)"> px</div>
                        <div class="editor-row"><span class="editor-label">右</span><input type="range" class="editor-slider" min="0" max="30" value="12" oninput="updateFourSides('padding','r',this.value)"><input type="number" class="editor-input" id="pad-r" value="12" style="width:55px;" oninput="updateFourSides('padding','r',this.value)"> px</div>
                        <div class="editor-row"><span class="editor-label">下</span><input type="range" class="editor-slider" min="0" max="30" value="8" oninput="updateFourSides('padding','b',this.value)"><input type="number" class="editor-input" id="pad-b" value="8" style="width:55px;" oninput="updateFourSides('padding','b',this.value)"> px</div>
                        <div class="editor-row"><span class="editor-label">左</span><input type="range" class="editor-slider" min="0" max="30" value="12" oninput="updateFourSides('padding','l',this.value)"><input type="number" class="editor-input" id="pad-l" value="12" style="width:55px;" oninput="updateFourSides('padding','l',this.value)"> px</div>
                    </div>
                </div>

                <!-- 外边距 -->
                <div class="four-sides-control">
                    <div class="four-sides-header">
                        <span>外边距</span>
                        <label class="four-sides-mode-toggle">
                            <input type="checkbox" id="margin-unified" checked
                                   onchange="toggleFourSidesMode('margin', this.checked)">
                            统一控制
                        </label>
                    </div>
                    <div class="four-sides-uniform" id="margin-uniform">
                        <div class="editor-row">
                            <span class="editor-label">全部</span>
                            <input type="range" class="editor-slider" id="mar-all-slider" min="0" max="20" value="0"
                                   oninput="updateFourSidesUniform('margin', this.value)">
                            <input type="number" class="editor-input" id="mar-all-input" value="0" style="width:55px;"
                                   oninput="updateFourSidesUniform('margin', this.value)"> px
                        </div>
                    </div>
                    <div class="four-sides-individual" id="margin-individual">
                        <div class="editor-row"><span class="editor-label">上</span><input type="range" class="editor-slider" min="0" max="20" value="0" oninput="updateFourSides('margin','t',this.value)"><input type="number" class="editor-input" id="mar-t" value="0" style="width:55px;" oninput="updateFourSides('margin','t',this.value)"> px</div>
                        <div class="editor-row"><span class="editor-label">右</span><input type="range" class="editor-slider" min="0" max="20" value="0" oninput="updateFourSides('margin','r',this.value)"><input type="number" class="editor-input" id="mar-r" value="0" style="width:55px;" oninput="updateFourSides('margin','r',this.value)"> px</div>
                        <div class="editor-row"><span class="editor-label">下</span><input type="range" class="editor-slider" min="0" max="20" value="0" oninput="updateFourSides('margin','b',this.value)"><input type="number" class="editor-input" id="mar-b" value="0" style="width:55px;" oninput="updateFourSides('margin','b',this.value)"> px</div>
                        <div class="editor-row"><span class="editor-label">左</span><input type="range" class="editor-slider" min="0" max="20" value="0" oninput="updateFourSides('margin','l',this.value)"><input type="number" class="editor-input" id="mar-l" value="0" style="width:55px;" oninput="updateFourSides('margin','l',this.value)"> px</div>
                    </div>
                </div>

                

                <!-- 气泡背景图 -->
<div style="border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 12px;">
    <div class="editor-switch-row">
        <span style="font-size: 12px; font-weight: 500;">气泡背景图</span>
        <label class="editor-switch">
            <input type="checkbox" id="bubble-bg-enable" onchange="toggleBubbleBgImage(this.checked)">
            <span class="editor-switch-slider"></span>
        </label>
    </div>
    <div id="bubble-bg-settings" style="display: none;">
        <div class="editor-row">
            <span class="editor-label">背景URL</span>
            <input type="text" class="editor-input" id="bubble-bg-url" placeholder="输入图片URL"
                   onchange="updateBubbleConfig('bgUrl', this.value)">
        </div>
        <div class="editor-row">
            <span class="editor-label">上传背景</span>
            <input type="file" class="editor-input" accept="image/*" onchange="handleBubbleBgUpload(this)">
        </div>
        <div class="editor-row">
            <span class="editor-label">填充模式</span>
            <select class="editor-select" id="bubble-bg-size" onchange="updateBubbleConfig('bgSize', this.value)">
                <option value="cover">铺满 (cover)</option>
                <option value="contain">完整显示 (contain)</option>
                <option value="auto">原始大小 (auto)</option>
                <option value="100% 100%">拉伸 (stretch)</option>
            </select>
        </div>
        <div class="editor-row">
            <span class="editor-label">显示位置</span>
            <div class="bg-position-grid" id="bubble-bg-position-grid">
                <button class="pos-btn" onclick="setBubbleBgPos('left top')" data-pos="left top">↖</button>
                <button class="pos-btn" onclick="setBubbleBgPos('center top')" data-pos="center top">↑</button>
                <button class="pos-btn" onclick="setBubbleBgPos('right top')" data-pos="right top">↗</button>
                <button class="pos-btn" onclick="setBubbleBgPos('left center')" data-pos="left center">←</button>
                <button class="pos-btn active" onclick="setBubbleBgPos('center center')" data-pos="center center">●</button>
                <button class="pos-btn" onclick="setBubbleBgPos('right center')" data-pos="right center">→</button>
                <button class="pos-btn" onclick="setBubbleBgPos('left bottom')" data-pos="left bottom">↙</button>
                <button class="pos-btn" onclick="setBubbleBgPos('center bottom')" data-pos="center bottom">↓</button>
                <button class="pos-btn" onclick="setBubbleBgPos('right bottom')" data-pos="right bottom">↘</button>
            </div>
        </div>
    </div>
</div>

<!-- 气泡颜色（背景图关闭时显示） -->
<div id="bubble-color-section">
    <div id="bubble-sent-color-picker"></div>
    <div id="bubble-received-color-picker"></div>
</div>

                <!-- 边框 -->
<div style="border: 1px solid var(--border-color); border-radius: 8px; padding: 12px; margin-bottom: 12px;">
    <span style="font-size: 12px; font-weight: 500; display: block; margin-bottom: 8px;">边框</span>
    <div class="editor-row">
        <span class="editor-label">样式</span>
        <select class="editor-select" id="bubble-border-style" onchange="updateBubbleConfig('borderStyle', this.value); if(this.value !== 'solid' && colorPickerRegistry['bubbleBorderColor'] && cpIsGradient('bubbleBorderColor')) showCustomAlert('渐变边框仅支持实线样式，其他样式会被忽略', 'warning', '提示');">
            <option value="solid">实线</option>
            <option value="dashed">虚线</option>
            <option value="dotted">点线</option>
            <option value="double">双线</option>
            <option value="groove">凹槽</option>
            <option value="ridge">脊线</option>
        </select>
    </div>

    <!-- 边框粗细四边控制 -->
    <div class="four-sides-control">
        <div class="four-sides-header">
            <span>边框粗细</span>
            <label class="four-sides-mode-toggle">
                <input type="checkbox" id="borderWidth-unified" checked
                       onchange="toggleFourSidesMode('borderWidth', this.checked)">
                统一控制
            </label>
        </div>
        <div class="four-sides-uniform" id="borderWidth-uniform">
            <div class="editor-row">
                <span class="editor-label">全部</span>
                <input type="range" class="editor-slider" id="bw-all-slider" min="0" max="10" value="0"
                       oninput="updateFourSidesUniform('borderWidth', this.value)">
                <input type="number" class="editor-input" id="bw-all-input" value="0" style="width:55px;"
                       oninput="updateFourSidesUniform('borderWidth', this.value)"> px
            </div>
        </div>
        <div class="four-sides-individual" id="borderWidth-individual">
            <div class="editor-row">
                <span class="editor-label">上</span>
                <input type="range" class="editor-slider" min="0" max="10" value="0"
                       oninput="updateFourSides('borderWidth','t',this.value)">
                <input type="number" class="editor-input" id="bw-t" value="0" style="width:55px;"
                       oninput="updateFourSides('borderWidth','t',this.value)"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">右</span>
                <input type="range" class="editor-slider" min="0" max="10" value="0"
                       oninput="updateFourSides('borderWidth','r',this.value)">
                <input type="number" class="editor-input" id="bw-r" value="0" style="width:55px;"
                       oninput="updateFourSides('borderWidth','r',this.value)"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">下</span>
                <input type="range" class="editor-slider" min="0" max="10" value="0"
                       oninput="updateFourSides('borderWidth','b',this.value)">
                <input type="number" class="editor-input" id="bw-b" value="0" style="width:55px;"
                       oninput="updateFourSides('borderWidth','b',this.value)"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">左</span>
                <input type="range" class="editor-slider" min="0" max="10" value="0"
                       oninput="updateFourSides('borderWidth','l',this.value)">
                <input type="number" class="editor-input" id="bw-l" value="0" style="width:55px;"
                       oninput="updateFourSides('borderWidth','l',this.value)"> px
            </div>
        </div>
    </div>

    <div id="bubble-border-color-picker"></div>
</div>
</div>
</div>

        <!-- ====== 气泡阴影 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="5"/><path d="M12 1v2M12 21v2M4.22 4.22l1.42 1.42M18.36 18.36l1.42 1.42M1 12h2M21 12h2"/></svg>
                    气泡阴影
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div id="bubble-shadow-picker"></div>
            </div>
        </div>

        <!-- ====== 气泡装饰 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                    气泡装饰
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
            
    <div class="decoration-list" id="bubbleDecoList">
        <!-- 动态生成 -->
    </div>
    <button class="add-decoration-btn" onclick="addBubbleDeco()">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="12" y1="5" x2="12" y2="19"/>
            <line x1="5" y1="12" x2="19" y2="12"/>
        </svg>
        添加气泡装饰
    </button>
</div>
            
        </div>

        <!-- ====== 气泡小尾巴 ====== -->
<div class="collapse-section">
    <div class="collapse-header" onclick="toggleCollapse(this)">
        <span class="collapse-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 11.5a8.38 8.38 0 0 1-.9 3.8 8.5 8.5 0 0 1-7.6 4.7 8.38 8.38 0 0 1-3.8-.9L3 21l1.9-5.7a8.38 8.38 0 0 1-.9-3.8 8.5 8.5 0 0 1 4.7-7.6 8.38 8.38 0 0 1 3.8-.9h.5a8.48 8.48 0 0 1 8 8v.5z"/></svg>
            气泡小尾巴
        </span>
        <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="collapse-body">

        <!-- 启用开关 -->
        <div class="editor-switch-row">
            <span class="editor-label">启用小尾巴</span>
            <label class="editor-switch">
                <input type="checkbox" id="tail-enable" onchange="updateTailConfig('enabled', this.checked)">
                <span class="editor-switch-slider"></span>
            </label>
        </div>

        <div id="tail-settings" style="display:none;">

            <!-- 内置样式 -->
            <div style="margin-bottom:12px;">
                <span class="editor-label" style="display:block;margin-bottom:8px;">内置样式</span>
                <div class="wave-style-grid" id="tail-preset-grid">
                    <div class="wave-style-option active" onclick="setTailPreset('triangle')" data-style="triangle">
                        <span></span> 三角
                    </div>
                    <div class="wave-style-option" onclick="setTailPreset('round')" data-style="round">
                        <span></span> 圆弧
                    </div>
                    <div class="wave-style-option" onclick="setTailPreset('bubble')" data-style="bubble">
                        <span></span> 气泡
                    </div>
                    <div class="wave-style-option" onclick="setTailPreset('sharp')" data-style="sharp">
                        <span></span> 尖角
                    </div>
                    <div class="wave-style-option" onclick="setTailPreset('custom')" data-style="custom">
                        <span></span> 自定义
                    </div>
                </div>
            </div>

            <!-- 自定义图片（custom模式显示） -->
            <div id="tail-custom-section" style="display:none;">
                <div class="editor-row">
                    <span class="editor-label">图片URL</span>
                    <input type="text" class="editor-input" id="tail-img-url" placeholder="小尾巴图片URL"
                           onchange="updateTailConfig('imgUrl', this.value)">
                </div>
                <div class="editor-row">
                    <span class="editor-label">上传图片</span>
                    <input type="file" class="editor-input" accept="image/*" onchange="handleTailUpload(this)">
                </div>
            </div>

            <!-- 挂载位置 -->
            <div class="editor-row">
                <span class="editor-label">挂载位置</span>
                <select class="editor-select" id="tail-anchor" onchange="updateTailConfig('anchor', this.value)">
                    <option value="bottom-left">↙ 左下</option>
                    <option value="bottom-right" selected>↘ 右下</option>
                    <option value="top-left">↖ 左上</option>
                    <option value="top-right">↗ 右上</option>
                    <option value="left-center">← 左中</option>
                    <option value="right-center">→ 右中</option>
                </select>
            </div>

<div class="editor-row">
    <span class="editor-label">图层位置</span>
    <select class="editor-select" id="tail-pseudo" onchange="updateTailConfig('pseudo', this.value)">
        <option value="after" selected>::after (顶层/覆盖)</option>
        <option value="before">::before (底层/垫底)</option>
    </select>
</div>

            <!-- 对方尾巴镜像 -->
            <div class="editor-switch-row">
                <span class="editor-label">对方自动镜像</span>
                <label class="editor-switch">
                    <input type="checkbox" id="tail-auto-mirror" checked
                           onchange="updateTailConfig('autoMirror', this.checked)">
                    <span class="editor-switch-slider"></span>
                </label>
            </div>

            <!-- 尺寸 -->
            <div class="editor-row">
                <span class="editor-label">宽度</span>
                <input type="range" class="editor-slider" id="tail-width" min="4" max="40" value="12"
                       oninput="updateTailConfig('width', this.value); this.nextElementSibling.value=this.value">
                <input type="number" class="editor-input" id="tail-width-input" value="12" min="4" max="40" style="width:55px;"
                       oninput="updateTailConfig('width', this.value); document.getElementById('tail-width').value=this.value"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">高度</span>
                <input type="range" class="editor-slider" id="tail-height" min="4" max="40" value="16"
                       oninput="updateTailConfig('height', this.value); this.nextElementSibling.value=this.value">
                <input type="number" class="editor-input" id="tail-height-input" value="16" min="4" max="40" style="width:55px;"
                       oninput="updateTailConfig('height', this.value); document.getElementById('tail-height').value=this.value"> px
            </div>

            <!-- 偏移 -->
            <div class="editor-row">
                <span class="editor-label">X偏移</span>
                <input type="range" class="editor-slider" id="tail-offset-x" min="-30" max="30" value="0"
                       oninput="updateTailConfig('offsetX', this.value); this.nextElementSibling.value=this.value">
                <input type="number" class="editor-input" id="tail-offset-x-input" value="0" style="width:55px;"
                       oninput="updateTailConfig('offsetX', this.value); document.getElementById('tail-offset-x').value=this.value"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">Y偏移</span>
                <input type="range" class="editor-slider" id="tail-offset-y" min="-30" max="30" value="0"
                       oninput="updateTailConfig('offsetY', this.value); this.nextElementSibling.value=this.value">
                <input type="number" class="editor-input" id="tail-offset-y-input" value="0" style="width:55px;"
                       oninput="updateTailConfig('offsetY', this.value); document.getElementById('tail-offset-y').value=this.value"> px
            </div>

            <!-- 翻转 -->
            <div class="editor-row">
                <span class="editor-label">翻转</span>
                <select class="editor-select" id="tail-flip" onchange="updateTailConfig('flip', this.value)">
                    <option value="0">无</option>
                    <option value="1">水平翻转</option>
                    <option value="2">垂直翻转</option>
                    <option value="3">180°旋转</option>
                </select>
            </div>

            <!-- 小尾巴颜色 -->
            <div id="tail-color-picker"></div>

            <!-- 自定义CSS -->
            <div style="border-top:1px dashed var(--border-color);margin:12px 0;padding-top:12px;">
                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px;">
                    <span style="font-size:12px;font-weight:500;">自定义CSS</span>
                    <button class="editor-btn" onclick="insertTailCSSExample()" style="padding:4px 8px;font-size:11px;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:12px;height:12px;"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                        填入示例
                    </button>
                </div>
                <textarea class="editor-textarea" id="tail-custom-css" rows="5" 
                          placeholder="/* 自定义小尾巴CSS */&#10;/* 会附加到小尾巴元素上 */"
                          onchange="updateTailConfig('customCss', this.value)"></textarea>
                <div class="editor-btn-row">
                    <button class="editor-btn" onclick="copyTailCSS()">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="width:14px;height:14px;"><rect x="9" y="9" width="13" height="13" rx="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        复制
                    </button>
                </div>
            </div>

        </div>
    </div>
</div>
        
        <!-- ====== 语音消息 ====== -->
<div class="collapse-section">
    <div class="collapse-header" data-scroll-to="voice" onclick="toggleCollapse(this)">
        <span class="collapse-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/></svg>
            语音消息
        </span>
        <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="collapse-body">
        <!-- 波形样式 -->
        <div style="margin-bottom: 12px;">
            <span class="editor-label" style="display:block;margin-bottom:8px;">波形样式</span>
            <!-- 在 "波形样式" 的 wave-style-grid 之前插入 -->
<div class="editor-row" style="margin-bottom:12px;">
    <span class="editor-label">波形来源</span>
    <select class="editor-select" id="voice-wave-source" onchange="setVoiceWaveSource(this.value)">
        <option value="builtin">内置样式</option>
        <option value="custom">自定义图标</option>
    </select>
</div>

<!-- 自定义图标设置（默认隐藏） -->
<div id="voice-custom-icon-section" style="display:none; margin-bottom:12px;">
    <div class="editor-row">
        <span class="editor-label">图标URL</span>
        <input type="text" class="editor-input" id="voice-custom-icon-url" 
               placeholder="支持 png/svg/gif/apng/webp"
               onchange="updateVoiceCustomIcon('url', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">上传图标</span>
        <input type="file" class="editor-input" accept="image/*" 
               onchange="handleVoiceIconUpload(this)">
    </div>
    <div class="editor-row">
        <span class="editor-label">图标宽度</span>
        <input type="range" class="editor-slider" id="voice-icon-width" min="16" max="120" value="50"
               oninput="updateVoiceCustomIcon('width', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="50" style="width:55px;"
               oninput="updateVoiceCustomIcon('width', this.value); document.getElementById('voice-icon-width').value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">图标高度</span>
        <input type="range" class="editor-slider" id="voice-icon-height" min="10" max="60" value="16"
               oninput="updateVoiceCustomIcon('height', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="16" style="width:55px;"
               oninput="updateVoiceCustomIcon('height', this.value); document.getElementById('voice-icon-height').value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">渲染模式</span>
        <select class="editor-select" id="voice-icon-render-mode" 
                onchange="updateVoiceCustomIcon('renderMode', this.value)">
            <option value="mask">跟随气泡颜色（mask）</option>
            <option value="image">保持原色（image）</option>
        </select>
    </div>
    <p style="font-size:11px; color:var(--text-muted); margin-top:6px; line-height:1.4;">
        mask模式：图标颜色跟随气泡文字色，适合单色SVG/PNG<br>
        image模式：保持图标原始颜色，适合彩色图/GIF动图
    </p>
</div>
            <div class="wave-style-grid" id="wave-style-grid">
                <div class="wave-style-option active" onclick="setVoiceWaveStyle('bars')" data-style="bars">
                    <span>▎▌▎▌</span> 条形
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('sine')" data-style="sine">
                    <span>〰️</span> 正弦波
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('dots')" data-style="dots">
                    <span>● ● ●</span> 圆点
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('line')" data-style="line">
                    <span>─━─</span> 线条
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('pointed')" data-style="pointed">
                    <span>╱╲╱╲</span> 锯齿
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('bubble')" data-style="bubble">
                    <span>○◎●</span> 气泡
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('equalizer')" data-style="equalizer">
                    <span>▁▃▅▇</span> 均衡器
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('pulse')" data-style="pulse">
                    <span>╶╴♥╶╴</span> 心跳
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('diamond')" data-style="diamond">
                    <span>◇◆◇◆</span> 菱形
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('ribbon')" data-style="ribbon">
                    <span>∿∿∿</span> 飘带
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('blocks')" data-style="blocks">
                    <span>▪▫▪▫</span> 方块
                </div>
                <div class="wave-style-option" onclick="setVoiceWaveStyle('spring')" data-style="spring">
                    <span>⌇⌇⌇</span> 弹簧
                </div>
            </div>
        </div>
        
        <!-- 修正点：原来这里多了关闭标签，现在移到底部 -->
        
        <div class="editor-row">
            <span class="editor-label">波形条数</span>
            <input type="range" class="editor-slider" id="voice-wave-count" min="3" max="12" value="4"
                   oninput="updateVoiceConfig('waveCount', this.value); document.getElementById('voice-wave-count-input').value=this.value">
            <input type="number" class="editor-input" id="voice-wave-count-input" value="4" min="3" max="12" style="width:60px;"
                   oninput="updateVoiceConfig('waveCount', this.value); document.getElementById('voice-wave-count').value=this.value">
        </div>

        <div style="border-top: 1px dashed var(--border-color); margin: 12px 0; padding-top: 12px;">
            <span style="font-size: 12px; font-weight: 500; display: block; margin-bottom: 10px;">转文字气泡</span>
            <div class="editor-row">
                <span class="editor-label">位置</span>
                <select class="editor-select" id="voice-text-position" onchange="updateVoiceConfig('textPosition', this.value)">
                    <option value="bottom">下方</option>
                    <option value="top">上方</option>
                    <option value="left">左侧</option>
                    <option value="right">右侧</option>
                </select>
            </div>
            <div class="editor-row">
                <span class="editor-label">字体大小</span>
                <input type="range" class="editor-slider" id="voice-text-fontsize" min="10" max="20" value="14"
                       oninput="updateVoiceConfig('textFontSize', this.value); document.getElementById('voice-text-fontsize-input').value=this.value">
                <input type="number" class="editor-input" id="voice-text-fontsize-input" value="14" min="10" max="20" style="width:60px;"
                       oninput="updateVoiceConfig('textFontSize', this.value); document.getElementById('voice-text-fontsize').value=this.value"> px
            </div>
            <div class="editor-row">
                <span class="editor-label">圆角</span>
                <input type="range" class="editor-slider" id="voice-text-radius" min="0" max="24" value="12"
                       oninput="updateVoiceConfig('textRadius', this.value); document.getElementById('voice-text-radius-input').value=this.value">
                <input type="number" class="editor-input" id="voice-text-radius-input" value="12" min="0" max="24" style="width:60px;"
                       oninput="updateVoiceConfig('textRadius', this.value); document.getElementById('voice-text-radius').value=this.value"> px
            </div>
            <div id="voice-text-color-picker"></div>
            <div id="voice-text-bg-color-picker"></div>
            <div class="editor-row">
                <span class="editor-label">边框粗细</span>
                <input type="range" class="editor-slider" id="voice-text-border-w" min="0" max="5" value="0"
                       oninput="updateVoiceConfig('textBorderWidth', this.value); document.getElementById('voice-text-border-w-input').value=this.value">
                <input type="number" class="editor-input" id="voice-text-border-w-input" value="0" min="0" max="5" style="width:60px;"
                       oninput="updateVoiceConfig('textBorderWidth', this.value); document.getElementById('voice-text-border-w').value=this.value"> px
            </div>
            <div id="voice-text-border-color-picker"></div>
            <div id="voice-text-shadow-picker"></div>
            <div class="editor-row">
                <span class="editor-label">背景URL</span>
                <input type="text" class="editor-input" id="voice-text-bg-url" placeholder="转文字框背景图URL"
                       onchange="updateVoiceConfig('textBgUrl', this.value)">
            </div>
        </div>
    </div> <!-- 这里的 div 才是关闭 collapse-body -->
</div>

        <!-- ====== 表情消息 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" data-scroll-to="emoji" onclick="toggleCollapse(this)">
    <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M8 14s1.5 2 4 2 4-2 4-2"/><line x1="9" y1="9" x2="9.01" y2="9"/><line x1="15" y1="9" x2="15.01" y2="9"/></svg>
                    表情消息
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-switch-row">
                    <span class="editor-label">显示气泡</span>
                    <label class="editor-switch">
                        <input type="checkbox" id="emoji-show-bubble" checked onchange="updateBubbleConfig('emojiShowBubble', this.checked)">
                        <span class="editor-switch-slider"></span>
                    </label>
                </div>
                <div class="editor-row">
                    <span class="editor-label">最大尺寸</span>
                    <input type="range" class="editor-slider" id="emoji-max-size" min="40" max="200" value="100"
       oninput="updateBubbleConfig('emojiMaxSize', this.value); document.getElementById('emoji-max-size-input').value=this.value">
                    <input type="number" class="editor-input" id="emoji-max-size-input" value="100" min="40" max="200" style="width:60px;"
       oninput="updateBubbleConfig('emojiMaxSize', this.value); document.getElementById('emoji-max-size').value=this.value"> px
                </div>
                <div class="editor-row">
    <span class="editor-label">圆角</span>
    <input type="range" class="editor-slider" id="emoji-radius" min="0" max="50" value="8"
           oninput="updateBubbleConfig('emojiRadius', this.value); document.getElementById('emoji-radius-input').value=this.value">
    <input type="number" class="editor-input" id="emoji-radius-input" value="8" min="0" max="50" style="width:60px;"
           oninput="updateBubbleConfig('emojiRadius', this.value); document.getElementById('emoji-radius').value=this.value"> px
</div>
            </div>
        </div>

        <!-- ====== 图片消息 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" data-scroll-to="image" onclick="toggleCollapse(this)">
    <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/></svg>
                    图片消息
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-switch-row">
                    <span class="editor-label">显示气泡</span>
                    <label class="editor-switch">
                        <input type="checkbox" id="image-show-bubble" checked onchange="updateBubbleConfig('imageShowBubble', this.checked)">
                        <span class="editor-switch-slider"></span>
                    </label>
                </div>
                <div class="editor-row">
    <span class="editor-label">最大宽度</span>
    <input type="range" class="editor-slider" id="image-max-w" min="80" max="300" value="150"
           oninput="updateBubbleConfig('imageMaxWidth', this.value); document.getElementById('image-max-w-input').value=this.value; document.getElementById('image-max-w-val').textContent=this.value+'px'">
    <input type="number" class="editor-input" id="image-max-w-input" value="150" min="80" max="300" style="width:60px;"
           oninput="updateBubbleConfig('imageMaxWidth', this.value); document.getElementById('image-max-w').value=this.value; document.getElementById('image-max-w-val').textContent=this.value+'px'"> px
</div>
<div class="editor-row">
    <span class="editor-label">最大高度</span>
    <input type="range" class="editor-slider" id="image-max-h" min="80" max="300" value="150"
           oninput="updateBubbleConfig('imageMaxHeight', this.value); document.getElementById('image-max-h-input').value=this.value; document.getElementById('image-max-h-val').textContent=this.value+'px'">
    <input type="number" class="editor-input" id="image-max-h-input" value="150" min="80" max="300" style="width:60px;"
           oninput="updateBubbleConfig('imageMaxHeight', this.value); document.getElementById('image-max-h').value=this.value; document.getElementById('image-max-h-val').textContent=this.value+'px'"> px
</div>
<div class="editor-row">
    <span class="editor-label">图片圆角</span>
    <input type="range" class="editor-slider" id="image-radius" min="0" max="30" value="10"
           oninput="updateBubbleConfig('imageRadius', this.value); document.getElementById('image-radius-input').value=this.value; document.getElementById('image-radius-val').textContent=this.value+'px'">
    <input type="number" class="editor-input" id="image-radius-input" value="10" min="0" max="30" style="width:60px;"
           oninput="updateBubbleConfig('imageRadius', this.value); document.getElementById('image-radius').value=this.value; document.getElementById('image-radius-val').textContent=this.value+'px'"> px
</div>

                <!-- 占位图设置 -->
                <div style="border-top: 1px dashed var(--border-color); margin: 12px 0; padding-top: 12px;">
                    <span style="font-size: 12px; font-weight: 500; display: block; margin-bottom: 10px;">占位图设置</span>
                    <div class="placeholder-type-grid">
                        <button class="placeholder-type-btn active" onclick="setPlaceholderType('url')" data-type="url">URL</button>
                        <button class="placeholder-type-btn" onclick="setPlaceholderType('upload')" data-type="upload">上传</button>
                        <button class="placeholder-type-btn" onclick="setPlaceholderType('svg')" data-type="svg">SVG</button>
                        <button class="placeholder-type-btn" onclick="setPlaceholderType('emoji')" data-type="emoji">Emoji</button>
                        <button class="placeholder-type-btn" onclick="setPlaceholderType('text')" data-type="text">文字</button>
                    </div>
                    <div class="placeholder-config-section show" id="placeholder-url-config">
                        <div class="editor-row">
                            <span class="editor-label">URL</span>
                            <input type="text" class="editor-input" id="placeholder-url" placeholder="占位图片URL"
                                   onchange="updateBubbleConfig('placeholderUrl', this.value)">
                        </div>
                    </div>
                    <div class="placeholder-config-section" id="placeholder-upload-config">
                        <div class="editor-row">
                            <span class="editor-label">上传</span>
                            <input type="file" class="editor-input" accept="image/*" onchange="handlePlaceholderUpload(this)">
                        </div>
                    </div>
                    <div class="placeholder-config-section" id="placeholder-svg-config">
                        <div class="editor-row" style="flex-direction:column;align-items:stretch;">
                            <span class="editor-label" style="margin-bottom:6px;">SVG代码</span>
                            <textarea class="editor-textarea" id="placeholder-svg" rows="4" placeholder="<svg>...</svg>"
                                      onchange="updateBubbleConfig('placeholderSvg', this.value)"></textarea>
                        </div>
                    </div>
                    <div class="placeholder-config-section" id="placeholder-emoji-config">
                        <div class="editor-row">
                            <span class="editor-label">Emoji</span>
                            <input type="text" class="editor-input" id="placeholder-emoji" value="🖼️" maxlength="4"
                                   onchange="updateBubbleConfig('placeholderEmoji', this.value)">
                        </div>
                    </div>
                    <div class="placeholder-config-section" id="placeholder-text-config">
                        <div class="editor-row">
                            <span class="editor-label">文字</span>
                            <input type="text" class="editor-input" id="placeholder-text" placeholder="占位文字"
                                   onchange="updateBubbleConfig('placeholderText', this.value)">
                        </div>
                    </div>
                </div>

                <!-- 查看描述样式 -->
                <div style="border-top: 1px dashed var(--border-color); margin: 12px 0; padding-top: 12px;">
                    <span style="font-size: 12px; font-weight: 500; display: block; margin-bottom: 10px;">图片描述弹层</span>
                    <div id="image-desc-bg-color-picker"></div>
                    <div id="image-desc-font-color-picker"></div>
<div class="editor-row">
    <span class="editor-label">字体大小</span>
    <input type="range" class="editor-slider" id="image-desc-fontsize" min="10" max="24" value="14"
           oninput="updateBubbleConfig('descFontSize', this.value)">
    <input type="number" class="editor-input" id="image-desc-fontsize-input" value="14" style="width:60px;"
           oninput="updateBubbleConfig('descFontSize', this.value)"> px
</div>
<div class="editor-row">
    <span class="editor-label">字体URL</span>
    <input type="text" class="editor-input" id="desc-font-url" placeholder="字体文件URL"
           onchange="applyDescFont(this.value)">
</div>
<div class="editor-row">
    <span class="editor-label">上传字体</span>
    <input type="file" class="editor-input" accept=".woff,.woff2,.ttf,.otf" onchange="handleDescFontUpload(this)">
</div>
                    <div class="editor-row">
    <span class="editor-label">描述圆角</span>
    <input type="range" class="editor-slider" id="image-desc-radius" min="0" max="24" value="10"
           oninput="updateBubbleConfig('descRadius', this.value); document.getElementById('image-desc-radius-input').value=this.value">
    <input type="number" class="editor-input" id="image-desc-radius-input" value="10" min="0" max="24" style="width:60px;"
           oninput="updateBubbleConfig('descRadius', this.value); document.getElementById('image-desc-radius').value=this.value"> px
</div>
<div class="editor-row">
    <span class="editor-label">边框粗细</span>
    <input type="range" class="editor-slider" id="image-desc-border-w" min="0" max="20" value="0"
           oninput="updateBubbleConfig('descBorderWidth', this.value); document.getElementById('image-desc-border-w-input').value=this.value">
    <input type="number" class="editor-input" id="image-desc-border-w-input" value="0" min="0" max="5" style="width:60px;"
           oninput="updateBubbleConfig('descBorderWidth', this.value); document.getElementById('image-desc-border-w').value=this.value"> px
</div>
                    <div id="image-desc-border-color-picker"></div>
                </div>
            </div>
        </div>

    </div>
</div>

<!-- 对方的气泡 / 我方的气泡（继承整体，不需要单独页面，但保留tab结构） -->
<!-- ================= 我方气泡设置 (独立) ================= -->
<div class="editor-content hidden" id="content-sent-bubble">
    <div class="editor-group">
        <div class="collapse-section open">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">我方独立字体设置</span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body" style="display:block;">
                <!-- 核心：绑定到 fontSizeSent，ID 必须加 -sent 后缀防冲突 -->
                <div class="editor-row">
                    <span class="editor-label">字体大小</span>
                    <input type="range" class="editor-slider" id="font-size-slider-sent" min="12" max="72" value="15"
                           oninput="updateBubbleConfig('fontSizeSent', this.value); document.getElementById('font-size-input-sent').value=this.value">
                    <input type="number" class="editor-input" id="font-size-input-sent" value="15" min="12" max="72" style="width:60px;"
                           oninput="updateBubbleConfig('fontSizeSent', this.value); document.getElementById('font-size-slider-sent').value=this.value"> px
                </div>

                <!-- 之前已经做好的颜色组件，只需提供新的挂载点 ID -->
                <div id="font-color-sent-picker-alone"></div>
                <div id="bubble-sent-color-picker-alone"></div>
            </div>
        </div>
    </div>
</div>

<!-- ================= 对方气泡设置 (独立) ================= -->
<div class="editor-content hidden" id="content-received-bubble">
    <div class="editor-group">
        <div class="collapse-section open">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">对方独立字体设置</span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body" style="display:block;">
                <!-- 核心：绑定到 fontSizeRecv，ID 加 -recv -->
                <div class="editor-row">
                    <span class="editor-label">字体大小</span>
                    <input type="range" class="editor-slider" id="font-size-slider-recv" min="12" max="72" value="15"
                           oninput="updateBubbleConfig('fontSizeRecv', this.value); document.getElementById('font-size-input-recv').value=this.value">
                    <input type="number" class="editor-input" id="font-size-input-recv" value="15" min="12" max="72" style="width:60px;"
                           oninput="updateBubbleConfig('fontSizeRecv', this.value); document.getElementById('font-size-slider-recv').value=this.value"> px
                </div>

                <!-- 把“对方”相关的颜色组件挂载过来 -->
                <div id="font-color-recv-picker-alone"></div>
                <div id="bubble-recv-color-picker-alone"></div>
            </div>
        </div>
    </div>
</div>

 <!-- =============== 引用消息设置（整体） =============== -->
<div class="editor-content hidden" id="content-overall-reply">
    <div class="editor-group">

        <!-- 内置样式预设 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/></svg>
                    内置样式
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="wave-style-grid" id="reply-preset-grid">
                    <div class="wave-style-option active" onclick="setReplyPreset('default')" data-style="default">默认</div>
                    <div class="wave-style-option" onclick="setReplyPreset('wechat')" data-style="wechat">微信</div>
                    <div class="wave-style-option" onclick="setReplyPreset('telegram')" data-style="telegram">TG</div>
                    <div class="wave-style-option" onclick="setReplyPreset('custom')" data-style="custom">自定义</div>
                </div>
            </div>
        </div>

        <!-- 引用位置与布局 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/></svg>
                    位置与显示控制
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
            
                <div class="editor-row">
                    <span class="editor-label">引用位置</span>
                    <select class="editor-select" id="reply-position" onchange="updateReplyConfig('position', this.value)">
    <option value="inside-top">气泡内部 - 上方</option>
    <option value="inside-bottom">气泡内部 - 下方</option>
    <option value="above">气泡外部 - 上方</option>
    <option value="below">气泡外部 - 下方</option>
    <option value="outside-above">气泡外部上方(绝对定位)</option>
    <option value="outside-bottom">气泡外部下方(绝对定位)</option>
</select>
                </div>
                
                <div class="editor-switch-row">
                    <span class="editor-label">显示发送者名</span>
                    <label class="editor-switch">
                        <input type="checkbox" id="reply-show-sender" checked onchange="updateReplyConfig('showSender', this.checked)">
                        <span class="editor-switch-slider"></span>
                    </label>
                </div>
                <div class="editor-switch-row">
                    <span class="editor-label">显示时间戳</span>
                    <label class="editor-switch">
                        <input type="checkbox" id="reply-show-time" checked onchange="updateReplyConfig('showTime', this.checked)">
                        <span class="editor-switch-slider"></span>
                    </label>
                </div>
                <!-- ★★★ 新增：时间戳隐藏方式 ★★★ -->
<div id="reply-time-hide-method-section" style="display:none; margin-top:8px;">
    <div class="editor-row">
        <span class="editor-label">隐藏方式</span>
        <select class="editor-select" id="reply-time-hide-method" onchange="updateReplyConfig('timeHideMethod', this.value)">
            <option value="display-none">display:none（默认）</option>
            <option value="word-spacing">word-spacing挤出（兼容性更好）</option>
        </select>
    </div>
    
</div>
            </div>
        </div>

        <!-- 引用条/前缀样式 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="4" y1="6" x2="4" y2="18"/><line x1="8" y1="6" x2="20" y2="6"/><line x1="8" y1="12" x2="20" y2="12"/><line x1="8" y1="18" x2="16" y2="18"/></svg>
                    引用条/前缀
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">前缀样式</span>
                    <select class="editor-select" id="reply-bar-style" onchange="updateReplyConfig('barStyle', this.value)">
                        <option value="line">竖条</option>
                        <option value="sender">发送者名</option>
                        <option value="icon">图标</option>
                        <option value="none">无</option>
                    </select>
                </div>
                
                <!-- 前缀位置设置（非none时显示） -->
<div id="reply-bar-position-settings" style="display:none;">
    <div class="editor-row">
        <span class="editor-label">前缀位置</span>
        <select class="editor-select" id="reply-bar-placement" onchange="updateReplyConfig('barPlacement', this.value)">
            <option value="inside">气泡内</option>
            <option value="outside">气泡外</option>
        </select>
    </div>
    <div class="editor-row">
        <span class="editor-label">X偏移</span>
        <input type="range" class="editor-slider" id="reply-bar-offset-x" min="-50" max="50" value="0"
               oninput="updateReplyConfig('barOffsetX', this.value); document.getElementById('reply-bar-offset-x-input').value=this.value">
        <input type="number" class="editor-input" id="reply-bar-offset-x-input" value="0" style="width:55px;"
               oninput="updateReplyConfig('barOffsetX', this.value); document.getElementById('reply-bar-offset-x').value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">Y偏移</span>
        <input type="range" class="editor-slider" id="reply-bar-offset-y" min="-50" max="50" value="0"
               oninput="updateReplyConfig('barOffsetY', this.value); document.getElementById('reply-bar-offset-y-input').value=this.value">
        <input type="number" class="editor-input" id="reply-bar-offset-y-input" value="0" style="width:55px;"
               oninput="updateReplyConfig('barOffsetY', this.value); document.getElementById('reply-bar-offset-y').value=this.value"> px
    </div>
</div>

                <!-- 竖条设置 -->
                <div id="reply-bar-line-settings">
                    <div class="editor-row">
                        <span class="editor-label">竖条宽度</span>
                        <input type="range" class="editor-slider" id="reply-bar-width" min="1" max="10" value="3"
                               oninput="updateReplyConfig('barWidth', this.value); document.getElementById('reply-bar-width-input').value=this.value">
                        <input type="number" class="editor-input" id="reply-bar-width-input" value="3" style="width:50px;" 
                               oninput="updateReplyConfig('barWidth', this.value); document.getElementById('reply-bar-width').value=this.value"> 
                    </div>
                    <div id="reply-bar-color-picker"></div>
                    <!-- ★★★ 新增：竖线渐变方向（当竖条颜色为渐变时自动生效） ★★★ -->
<p style="font-size:11px; color:var(--text-muted); margin-top:4px;">
    竖条颜色设为渐变时，将自动应用渐变方向。推荐使用"↓ 向下"方向。
</p>
                </div>

                <!-- 前缀图标设置 -->
                <div id="reply-bar-icon-settings" style="display:none;">
                    <div class="editor-row">
                        <span class="editor-label">图标代码</span>
                        <input type="text" class="editor-input" id="reply-prefix-icon-nav" placeholder="例如: fa-solid fa-reply"
                               onchange="updateReplyConfig('prefixIconNav', this.value)">
                    </div>
                    <div class="editor-row">
                        <span class="editor-label">或者 URL</span>
                        <input type="text" class="editor-input" id="reply-prefix-icon-url" placeholder="图片URL"
                               onchange="updateReplyConfig('prefixIconUrl', this.value)">
                    </div>
                    <div class="editor-row">
                        <span class="editor-label">上传图标</span>
                        <input type="file" class="editor-input" accept="image/*" onchange="handleReplyPrefixIconUpload(this)">
                    </div>
                </div>

                <!-- 背景设置 -->
                <div id="reply-bg-color-picker"></div>
                
                <div class="editor-row">
                    <span class="editor-label">背景图URL</span>
                    <input type="text" class="editor-input" id="reply-bg-url" placeholder="引用区域背景图" 
                           onchange="updateReplyConfig('bgUrl', this.value)">
                </div>
                <div class="editor-row">
                    <span class="editor-label">上传背景</span>
                    <input type="file" class="editor-input" accept="image/*" onchange="handleReplyBgUpload(this)">
                </div>

                <div class="editor-row">
                    <span class="editor-label">背景圆角</span>
                    <input type="range" class="editor-slider" id="reply-bg-radius" min="0" max="20" value="6"
                           oninput="updateReplyConfig('bgRadius', this.value); document.getElementById('reply-bg-radius-input').value=this.value">
                    <input type="number" class="editor-input" id="reply-bg-radius-input" value="6" style="width:50px;"
                           oninput="updateReplyConfig('bgRadius', this.value); document.getElementById('reply-bg-radius').value=this.value">
                </div>

                <div class="editor-row">
                    <span class="editor-label">内边距</span>
                    <input type="range" class="editor-slider" id="reply-padding" min="0" max="20" value="6"
                           oninput="updateReplyConfig('padding', this.value); document.getElementById('reply-padding-input').value=this.value">
                    <input type="number" class="editor-input" id="reply-padding-input" value="6" style="width:50px;"
                           oninput="updateReplyConfig('padding', this.value); document.getElementById('reply-padding').value=this.value">
                </div>
            </div>
        </div>

        <!-- 文字样式 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7V4h16v3"/><path d="M9 20h6"/><path d="M12 4v16"/></svg>
                    文字样式
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">字体大小</span>
                    <input type="range" class="editor-slider" id="reply-font-size" min="10" max="24" value="12"
                           oninput="updateReplyConfig('fontSize', this.value); document.getElementById('reply-font-size-input').value=this.value">
                    <input type="number" class="editor-input" id="reply-font-size-input" value="12" style="width:50px;"
                           oninput="updateReplyConfig('fontSize', this.value); document.getElementById('reply-font-size').value=this.value"> px
                </div>
                
                <div class="editor-row">
                    <span class="editor-label">字体URL</span>
                    <input type="text" class="editor-input" id="reply-font-url" placeholder="引用区域字体URL"
                           onchange="applyReplyFont(this.value)">
                </div>
                <div class="editor-row">
                    <span class="editor-label">上传字体</span>
                    <input type="file" class="editor-input" accept=".woff,.woff2,.ttf,.otf" onchange="handleReplyFontUpload(this)">
                </div>

                <div id="reply-sender-color-picker"></div>
                <div id="reply-time-color-picker"></div>
                <div id="reply-msg-color-picker"></div>
            </div>
        </div>

        <!-- 跳转按钮 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><polyline points="12 8 12 12 14 14"/></svg>
                    跳转按钮
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">按钮类型</span>
                    <select class="editor-select" id="reply-jump-type" onchange="updateReplyConfig('jumpBtnType', this.value)">
                        <option value="icon">图标</option>
                        <option value="image">图片</option>
                        <option value="text">文字</option>
                        <option value="none">无</option>
                    </select>
                </div>
                <!-- ★★★ 新增：跳转按钮外置装饰 ★★★ -->
<div id="reply-jump-external-section" style="display:none;">
    <div class="editor-switch-row">
        <span class="editor-label">移出气泡外（伪元素装饰）</span>
        <label class="editor-switch">
            <input type="checkbox" id="reply-jump-external" onchange="updateReplyConfig('jumpBtnExternal', this.checked)">
            <span class="editor-switch-slider"></span>
        </label>
    </div>
    <div id="reply-jump-external-settings" style="display:none;">
        <div class="editor-row">
            <span class="editor-label">装饰文字</span>
            <input type="text" class="editor-input" id="reply-jump-external-text" value="跳转" placeholder="伪元素显示的文字"
                   onchange="updateReplyConfig('jumpBtnExternalText', this.value)">
        </div>
        <div class="editor-row">
            <span class="editor-label">装饰位置</span>
            <select class="editor-select" id="reply-jump-external-pos" onchange="updateReplyConfig('jumpBtnExternalPos', this.value)">
                <option value="right">右侧</option>
                <option value="left">左侧</option>
                <option value="top">上方</option>
                <option value="bottom">下方</option>
            </select>
        </div>
        <div class="editor-row">
    <span class="editor-label">间距</span>
    <input type="range" class="editor-slider" id="reply-jump-external-gap" min="0" max="20" value="6"
           oninput="updateReplyConfig('jumpBtnExternalGap', this.value); this.nextElementSibling.value=this.value">
    <input type="number" class="editor-input" id="reply-jump-external-gap-input" value="6" style="width:55px;"
           oninput="updateReplyConfig('jumpBtnExternalGap', this.value); document.getElementById('reply-jump-external-gap').value=this.value"> px
</div>
<div class="editor-row">
    <span class="editor-label">字体大小</span>
    <input type="range" class="editor-slider" id="reply-jump-external-fontsize" min="8" max="18" value="11"
           oninput="updateReplyConfig('jumpBtnExternalFontSize', this.value); this.nextElementSibling.value=this.value">
    <input type="number" class="editor-input" id="reply-jump-external-fontsize-input" value="11" style="width:55px;"
           oninput="updateReplyConfig('jumpBtnExternalFontSize', this.value); document.getElementById('reply-jump-external-fontsize').value=this.value"> px
</div>
<div class="editor-row">
    <span class="editor-label">圆角</span>
    <input type="range" class="editor-slider" id="reply-jump-external-radius" min="0" max="20" value="4"
           oninput="updateReplyConfig('jumpBtnExternalRadius', this.value); this.nextElementSibling.value=this.value">
    <input type="number" class="editor-input" id="reply-jump-external-radius-input" value="4" style="width:55px;"
           oninput="updateReplyConfig('jumpBtnExternalRadius', this.value); document.getElementById('reply-jump-external-radius').value=this.value"> px
</div>
<div class="editor-row">
    <span class="editor-label">内边距(横)</span>
    <input type="range" class="editor-slider" id="reply-jump-external-padx" min="2" max="20" value="10"
           oninput="updateReplyConfig('jumpBtnExternalPadX', this.value); this.nextElementSibling.value=this.value">
    <input type="number" class="editor-input" id="reply-jump-external-padx-input" value="10" style="width:55px;"
           oninput="updateReplyConfig('jumpBtnExternalPadX', this.value); document.getElementById('reply-jump-external-padx').value=this.value"> px
</div>
<div class="editor-row">
    <span class="editor-label">内边距(纵)</span>
    <input type="range" class="editor-slider" id="reply-jump-external-pady" min="1" max="12" value="3"
           oninput="updateReplyConfig('jumpBtnExternalPadY', this.value); this.nextElementSibling.value=this.value">
    <input type="number" class="editor-input" id="reply-jump-external-pady-input" value="3" style="width:55px;"
           oninput="updateReplyConfig('jumpBtnExternalPadY', this.value); document.getElementById('reply-jump-external-pady').value=this.value"> px
</div>
        <div id="reply-jump-external-bg-picker"></div>
        <div id="reply-jump-external-text-color-picker"></div>
    </div>
</div>
                <!-- 跳转按钮位置设置（非none时显示） -->
<div id="reply-jump-position-settings" style="display:none;">
    <div class="editor-row">
        <span class="editor-label">按钮位置</span>
        <select class="editor-select" id="reply-jump-placement" onchange="updateReplyConfig('jumpBtnPlacement', this.value)">
            <option value="inside">气泡内</option>
            <option value="outside">气泡外</option>
        </select>
    </div>
    <div class="editor-row">
        <span class="editor-label">X偏移</span>
        <input type="range" class="editor-slider" id="reply-jump-offset-x" min="-50" max="50" value="0"
               oninput="updateReplyConfig('jumpBtnOffsetX', this.value); document.getElementById('reply-jump-offset-x-input').value=this.value">
        <input type="number" class="editor-input" id="reply-jump-offset-x-input" value="0" style="width:55px;"
               oninput="updateReplyConfig('jumpBtnOffsetX', this.value); document.getElementById('reply-jump-offset-x').value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">Y偏移</span>
        <input type="range" class="editor-slider" id="reply-jump-offset-y" min="-50" max="50" value="0"
               oninput="updateReplyConfig('jumpBtnOffsetY', this.value); document.getElementById('reply-jump-offset-y-input').value=this.value">
        <input type="number" class="editor-input" id="reply-jump-offset-y-input" value="0" style="width:55px;"
               oninput="updateReplyConfig('jumpBtnOffsetY', this.value); document.getElementById('reply-jump-offset-y').value=this.value"> px
    </div>
</div>

                <!-- 图标设置 -->
                <div id="reply-jump-icon-settings" style="display:none;">
                    <div class="editor-row">
                        <span class="editor-label">图标代码</span>
                        <input type="text" class="editor-input" id="reply-jump-icon-name" placeholder="例如: mdi:arrow-up"
                               onchange="updateReplyConfig('jumpBtnIcon', this.value)">
                    </div>
                </div>

                <!-- 文字设置 -->
                <div id="reply-jump-text-settings" style="display:none;">
                    <div class="editor-row">
                        <span class="editor-label">按钮文字</span>
                        <input type="text" class="editor-input" id="reply-jump-text-content" placeholder="例如: GO"
                               onchange="updateReplyConfig('jumpBtnText', this.value)">
                    </div>
                </div>

                <!-- 图片设置 -->
                <div id="reply-jump-image-settings" style="display:none;">
                    <div class="editor-row">
                        <span class="editor-label">图片URL</span>
                        <input type="text" class="editor-input" id="reply-jump-url" placeholder="按钮图片URL"
                               onchange="updateReplyConfig('jumpBtnUrl', this.value)">
                    </div>
                    <div class="editor-row">
                        <span class="editor-label">上传图片</span>
                        <input type="file" class="editor-input" accept="image/*" onchange="handleReplyJumpUpload(this)">
                    </div>
                </div>

                <div class="editor-row">
                    <span class="editor-label">按钮大小</span>
                    <input type="range" class="editor-slider" id="reply-jump-size" min="12" max="32" value="16"
                           oninput="updateReplyConfig('jumpBtnSize', this.value); document.getElementById('reply-jump-size-input').value=this.value">
                    <input type="number" class="editor-input" id="reply-jump-size-input" value="16" style="width:50px;"
                           oninput="updateReplyConfig('jumpBtnSize', this.value); document.getElementById('reply-jump-size').value=this.value"> px
                </div>
                
                <!-- 新增：跳转按钮宽度 -->
<div class="editor-row">
    <span class="editor-label">按钮宽度</span>
    <input type="range" class="editor-slider" id="reply-jump-width" min="16" max="100" value="24"
           oninput="updateReplyConfig('jumpBtnWidth', this.value); document.getElementById('reply-jump-width-input').value=this.value">
    <input type="number" class="editor-input" id="reply-jump-width-input" value="24" style="width:50px;"
           oninput="updateReplyConfig('jumpBtnWidth', this.value); document.getElementById('reply-jump-width').value=this.value"> px
</div>

<!-- 新增：跳转按钮高度 -->
<div class="editor-row">
    <span class="editor-label">按钮高度</span>
    <input type="range" class="editor-slider" id="reply-jump-height" min="16" max="100" value="24"
           oninput="updateReplyConfig('jumpBtnHeight', this.value); document.getElementById('reply-jump-height-input').value=this.value">
    <input type="number" class="editor-input" id="reply-jump-height-input" value="24" style="width:50px;"
           oninput="updateReplyConfig('jumpBtnHeight', this.value); document.getElementById('reply-jump-height').value=this.value"> px
</div>

                <div id="reply-jump-color-picker"></div>
                <div id="reply-jump-bg-picker"></div>

                <div class="editor-row">
                    <span class="editor-label">按钮圆角</span>
                    <input type="range" class="editor-slider" id="reply-jump-radius" min="0" max="50" value="50"
                           oninput="updateReplyConfig('jumpBtnRadius', this.value); document.getElementById('reply-jump-radius-input').value=this.value">
                    <input type="number" class="editor-input" id="reply-jump-radius-input" value="50" style="width:50px;"
                           oninput="updateReplyConfig('jumpBtnRadius', this.value); document.getElementById('reply-jump-radius').value=this.value"> %
                </div>
            </div>
        </div>

    </div>
</div>

<!-- 对方引用（继承整体） -->
<div class="editor-content hidden" id="content-received-reply">
    <div class="editor-group">
        <p style="font-size:13px;color:var(--text-secondary);line-height:1.6;">对方引用样式继承整体设置。</p>
    </div>
</div>

<!-- 我方引用（继承整体） -->
<div class="editor-content hidden" id="content-sent-reply">
    <div class="editor-group">
        <p style="font-size:13px;color:var(--text-secondary);line-height:1.6;">我方引用样式继承整体设置。</p>
    </div>
</div>         

<div class="editor-content hidden" id="content-overall-transfer">
    <div class="editor-group">
        
        <!-- 基础内容设置 -->
<!-- 修改点1：删除了 class="open"，默认折叠 -->
<div class="collapse-section">
    <div class="collapse-header" onclick="toggleCollapse(this)">
        <span class="collapse-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="1" x2="12" y2="23"/><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"/></svg>
            内容与尺寸
        </span>
        <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="collapse-body">
        <div class="editor-row">
            <span class="editor-label">卡片宽度</span>
            <input type="range" class="editor-slider" id="trans-w" min="150" max="300" value="220"
                   oninput="updateTransferConfig('transferWidth', this.value); this.nextElementSibling.value=this.value">
            <input type="number" class="editor-input" value="220" style="width:55px;" 
                   oninput="updateTransferConfig('transferWidth', this.value); document.getElementById('trans-w').value=this.value"> px
        </div>
        <div class="editor-row">
            <span class="editor-label">卡片高度</span>
            <input type="range" class="editor-slider" id="trans-h" min="80" max="200" value="110"
                   oninput="updateTransferConfig('transferHeight', this.value); this.nextElementSibling.value=this.value">
            <input type="number" class="editor-input" value="110" style="width:55px;" 
                   oninput="updateTransferConfig('transferHeight', this.value); document.getElementById('trans-h').value=this.value"> px
        </div>
        
        <div style="border-top:1px dashed var(--border-color); margin:12px 0; padding-top:12px;">
            <!-- 修改点2：标题加开关 -->
            <div class="editor-switch-row" style="margin-bottom: 8px;">
                <span class="editor-label">显示标题</span>
                <label class="editor-switch">
                    <!-- 默认显示 -->
                    <input type="checkbox" id="trans-title-show" checked onchange="updateTransferConfig('transferTitleVisible', this.checked)">
                    <span class="editor-switch-slider"></span>
                </label>
            </div>
            <div id="trans-title-detail">
    <div class="editor-row">
        <span class="editor-label">标题(我方)</span>
        <input type="text" class="editor-input" id="trans-title-sent" value="💕 你发起的转账" 
               onchange="updateTransferConfig('transferTitleSent', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">标题(对方)</span>
        <input type="text" class="editor-input" id="trans-title-recv" value="💖 收到转账" 
               onchange="updateTransferConfig('transferTitleRecv', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">标题X偏移</span>
        <input type="range" class="editor-slider" min="-300" max="300" value="0"
               oninput="updateTransferConfig('transferTitleX', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="updateTransferConfig('transferTitleX', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">标题Y偏移</span>
        <input type="range" class="editor-slider" min="-300" max="300" value="0"
               oninput="updateTransferConfig('transferTitleY', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="updateTransferConfig('transferTitleY', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">标题图层</span>
        <select class="editor-select" onchange="updateTransferConfig('transferTitleLayer', this.value)">
            <option value="after" selected>::after（顶层）</option>
            <option value="before">::before（底层）</option>
        </select>
    </div>
</div>
            <!-- 修改点3：金额加开关 -->
            <div class="editor-switch-row" style="margin-top: 12px; margin-bottom: 8px;">
                <span class="editor-label">显示金额</span>
                <label class="editor-switch">
                    <input type="checkbox" id="trans-amount-show" checked onchange="updateTransferConfig('transferAmountVisible', this.checked)">
                    <span class="editor-switch-slider"></span>
                </label>
            </div>
            <div id="trans-amount-detail">
    <div class="editor-row">
        <span class="editor-label">金额(我方)</span>
        <input type="text" class="editor-input" id="trans-amt-sent" value="¥ 70.00" 
               onchange="updateTransferConfig('transferAmountSent', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">金额(对方)</span>
        <input type="text" class="editor-input" id="trans-amt-recv" value="¥ 5.20" 
               onchange="updateTransferConfig('transferAmountRecv', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">金额X偏移</span>
        <input type="range" class="editor-slider" min="-300" max="300" value="0"
               oninput="updateTransferConfig('transferAmountX', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="updateTransferConfig('transferAmountX', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">金额Y偏移</span>
        <input type="range" class="editor-slider" min="-300" max="300" value="0"
               oninput="updateTransferConfig('transferAmountY', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="updateTransferConfig('transferAmountY', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">金额图层</span>
        <select class="editor-select" onchange="updateTransferConfig('transferAmountLayer', this.value)">
            <option value="after" selected>::after（顶层）</option>
            <option value="before">::before（底层）</option>
        </select>
    </div>
</div>

            <!-- 修改点4：备注加开关 -->
            <div class="editor-switch-row" style="margin-top: 12px; margin-bottom: 8px;">
                <span class="editor-label">显示备注</span>
                <label class="editor-switch">
                    <input type="checkbox" id="trans-note-show" checked onchange="updateTransferConfig('transferNoteVisible', this.checked)">
                    <span class="editor-switch-slider"></span>
                </label>
            </div>
            <div id="trans-note-detail">
    <div class="editor-row">
        <span class="editor-label">备注(我方)</span>
        <input type="text" class="editor-input" id="trans-note-sent" value="转账" 
               onchange="updateTransferConfig('transferNoteSent', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">备注(对方)</span>
        <input type="text" class="editor-input" id="trans-note-recv" value="爱你么么哒" 
               onchange="updateTransferConfig('transferNoteRecv', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">备注X偏移</span>
        <input type="range" class="editor-slider" min="-300" max="300" value="0"
               oninput="updateTransferConfig('transferNoteX', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="updateTransferConfig('transferNoteX', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">备注Y偏移</span>
        <input type="range" class="editor-slider" min="-300" max="300" value="0"
               oninput="updateTransferConfig('transferNoteY', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="updateTransferConfig('transferNoteY', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">备注图层</span>
        <select class="editor-select" onchange="updateTransferConfig('transferNoteLayer', this.value)">
            <option value="after" selected>::after（顶层）</option>
            <option value="before">::before（底层）</option>
        </select>
    </div>
</div>

            <!-- 修改点5：状态加开关，并添加“对方状态” -->
            <div class="editor-switch-row" style="margin-top: 12px; margin-bottom: 8px;">
                <span class="editor-label">显示状态</span>
                <label class="editor-switch">
                    <input type="checkbox" id="trans-status-show" checked onchange="updateTransferConfig('transferStatusVisible', this.checked)">
                    <span class="editor-switch-slider"></span>
                </label>
            </div>
            <div id="trans-status-detail">
    <div class="editor-row">
        <span class="editor-label">状态(我方)</span>
        <input type="text" class="editor-input" id="trans-status" value="对方已收款" 
               onchange="updateTransferConfig('transferStatusSent', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">状态(对方)</span>
        <input type="text" class="editor-input" id="trans-status-recv" value="已收款" 
               onchange="updateTransferConfig('transferStatusRecv', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">状态X偏移</span>
        <input type="range" class="editor-slider" min="-300" max="300" value="0"
               oninput="updateTransferConfig('transferStatusX', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="updateTransferConfig('transferStatusX', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">状态Y偏移</span>
        <input type="range" class="editor-slider" min="-300" max="300" value="0"
               oninput="updateTransferConfig('transferStatusY', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="0" style="width:55px;"
               oninput="updateTransferConfig('transferStatusY', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">状态图层</span>
        <select class="editor-select" onchange="updateTransferConfig('transferStatusLayer', this.value)">
            <option value="after" selected>::after（顶层）</option>
            <option value="before">::before（底层）</option>
        </select>
    </div>
</div>
</div>
</div>
</div>


        <!-- 外观样样式 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><path d="M14.31 8l5.74 9.94M9.69 8h11.48M7.38 12l5.74-9.94M9.69 16L3.95 6.06M14.31 16H2.83m13.79-4l-5.74 9.94"/></svg>
                    外观样式
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">圆角</span>
                    <input type="range" class="editor-slider" id="trans-radius" min="0" max="30" value="12"
                           oninput="updateTransferConfig('transferRadius', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="12" style="width:55px;" 
                           oninput="updateTransferConfig('transferRadius', this.value); document.getElementById('trans-radius').value=this.value"> px
                </div>
                
                <div class="editor-switch-row">
                    <span class="editor-label">使用背景图 (覆盖背景色)</span>
                    <label class="editor-switch">
                        <input type="checkbox" id="trans-bg-img-enable" onchange="toggleTransferBgImage(this.checked)">
                        <span class="editor-switch-slider"></span>
                    </label>
                </div>
                
                <div id="trans-bg-url-section" style="display:none; margin-bottom:12px;">
                    <div class="editor-row">
                        <span class="editor-label">背景URL</span>
                        <input type="text" class="editor-input" id="trans-bg-url" placeholder="图片URL" 
       onchange="updateTransferBgUrl(this.value)" 
       oninput="updateTransferBgUrl(this.value)">
                    </div>
                    <div class="editor-row">
                        <span class="editor-label">上传图片</span>
                        <input type="file" class="editor-input" accept="image/*" onchange="handleTransferBgUpload(this)">
                    </div>
                </div>

                <div id="trans-bg-color-section">
                    <div id="transfer-bg-picker"></div>
                </div>

                <div style="height:1px; background:var(--border-color); margin:10px 0;"></div>

                <div class="editor-row">
                    <span class="editor-label">边框粗细</span>
                    <input type="range" class="editor-slider" id="trans-border-w" min="0" max="10" value="0"
                           oninput="updateTransferConfig('transferBorderWidth', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:55px;" 
                           oninput="updateTransferConfig('transferBorderWidth', this.value); document.getElementById('trans-border-w').value=this.value"> px
                </div>
                <div id="transfer-border-picker"></div>
                <div id="transfer-text-picker"></div>
<div id="transfer-shadow-picker"></div>
            </div>
        </div>

        <!-- 转账装饰 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>
                    转账装饰 (挂件)
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="decoration-list" id="transferDecoList">
                    <!-- 动态生成 -->
                </div>
                <button class="add-decoration-btn" onclick="addTransferDeco()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"/>
                        <line x1="5" y1="12" x2="19" y2="12"/>
                    </svg>
                    添加转账装饰
                </button>
            </div>
        </div>

    </div>
</div>
<!-- =============== 工具栏设置 =============== -->
<div class="editor-content hidden" id="content-overall-toolbar">
    <div class="editor-group">

        <!-- 工具栏布局 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2"/><line x1="3" y1="9" x2="21" y2="9"/></svg>
                    工具栏布局
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">列数</span>
                    <input type="range" class="editor-slider" id="toolbar-columns" min="3" max="6" value="4"
                           oninput="updateToolbarLayout('columns', this.value)">
                    <span id="toolbar-columns-val">4</span>
                </div>
                <div class="editor-row">
                    <span class="editor-label">间距</span>
                    <input type="range" class="editor-slider" id="toolbar-gap" min="4" max="20" value="10"
                           oninput="updateToolbarLayout('gap', this.value)">
                    <span id="toolbar-gap-val">10px</span>
                </div>
                <div class="editor-row">
                    <span class="editor-label">内边距</span>
                    <input type="range" class="editor-slider" id="toolbar-padding" min="4" max="24" value="12"
                           oninput="updateToolbarLayout('padding', this.value)">
                    <span id="toolbar-padding-val">12px</span>
                </div>
                <div class="editor-row">
                    <span class="editor-label">最大高度</span>
                    <input type="range" class="editor-slider" id="toolbar-maxheight" min="100" max="400" value="200"
                           oninput="updateToolbarLayout('maxHeight', this.value)">
                    <span id="toolbar-maxheight-val">200px</span>
                </div>
                <div id="toolbar-bg-color-picker"></div>
            </div>
        </div>

        <!-- 图标全局设置 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><circle cx="12" cy="12" r="3"/></svg>
                    图标全局设置
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">图标大小</span>
                    <input type="range" class="editor-slider" id="toolbar-icon-size" min="20" max="50" value="30"
                           oninput="updateToolbarLayout('iconSize', this.value)">
                    <span id="toolbar-icon-size-val">30px</span>
                </div>
                <div class="editor-row">
                    <span class="editor-label">图标圆角</span>
                    <input type="range" class="editor-slider" id="toolbar-icon-radius" min="0" max="50" value="50"
                           oninput="updateToolbarLayout('iconRadius', this.value)">
                    <span id="toolbar-icon-radius-val">50%</span>
                </div>
                <div class="editor-row">
                    <span class="editor-label">文字大小</span>
                    <input type="range" class="editor-slider" id="toolbar-label-size" min="8" max="16" value="10"
                           oninput="updateToolbarLayout('labelSize', this.value)">
                    <span id="toolbar-label-size-val">10px</span>
                </div>
                <div id="toolbar-icon-color-picker"></div>
                <div id="toolbar-label-color-picker"></div>
                <div id="toolbar-icon-shadow-picker"></div>
            </div>
        </div>

        <!-- 工具项列表 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="8" y1="6" x2="21" y2="6"/><line x1="8" y1="12" x2="21" y2="12"/><line x1="8" y1="18" x2="21" y2="18"/><line x1="3" y1="6" x2="3.01" y2="6"/><line x1="3" y1="12" x2="3.01" y2="12"/><line x1="3" y1="18" x2="3.01" y2="18"/></svg>
                    工具项列表
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div id="toolbarItemsList"></div>
                <button class="add-decoration-btn" onclick="addToolbarItem()" style="margin-top:10px;">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>
                    添加工具项
                </button>
            </div>
        </div>

    </div>
</div>

<!-- =============== 系统消息设置（整体） =============== -->
<div class="editor-content hidden" id="content-overall-system">
    <div class="editor-group">

        <!-- ====== 背景样式 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/></svg>
                    背景样式
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <!-- 找到这段并替换 -->
<!-- 原始代码位置：content-overall-system 中的"背景样式"collapse-body -->

<div class="collapse-body">
    <!-- 新增：背景类型开关 -->
    <div class="editor-switch-row">
        <span class="editor-label">使用背景颜色</span>
        <label class="editor-switch">
            <input type="checkbox" id="system-bg-color-enable" checked onchange="toggleSystemBgMode(this.checked)">
            <span class="editor-switch-slider"></span>
        </label>
    </div>

    <!-- 背景颜色（开关开启时显示） -->
    <div id="system-bg-color-section">
        <div id="system-bg-color-picker"></div>
    </div>

    <!-- 背景图URL（开关关闭时显示） -->
    <div id="system-bg-url-section" style="display:none;">
        <div class="editor-row">
            <span class="editor-label">背景图URL</span>
            <input type="text" class="editor-input" id="system-bg-url" placeholder="输入背景图片URL"
                   onchange="updateSystemConfig('bgUrl', this.value)">
        </div>
        <div class="editor-row">
            <span class="editor-label">上传背景</span>
            <input type="file" class="editor-input" accept="image/*" onchange="handleSystemBgUpload(this)">
        </div>
        <div class="editor-row">
            <span class="editor-label">填充模式</span>
            <select class="editor-select" id="system-bg-size" onchange="updateSystemConfig('bgSize', this.value)">
                <option value="cover">铺满 (cover)</option>
                <option value="contain">完整显示 (contain)</option>
                <option value="auto">原始大小 (auto)</option>
            </select>
        </div>
    </div>
</div>
</div>

        <!-- ====== 字体样式 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7V4h16v3"/><path d="M9 20h6"/><path d="M12 4v16"/></svg>
                    字体样式
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <!-- 字体颜色（纯色/渐变） -->
                <div id="system-font-color-picker"></div>

                <div class="editor-row">
                    <span class="editor-label">字体大小</span>
                    <input type="range" class="editor-slider" id="system-font-size" min="10" max="24" value="12"
                           oninput="updateSystemConfig('fontSize', this.value); document.getElementById('system-font-size-input').value=this.value">
                    <input type="number" class="editor-input" id="system-font-size-input" value="12" min="10" max="24" style="width:60px;"
                           oninput="updateSystemConfig('fontSize', this.value); document.getElementById('system-font-size').value=this.value"> px
                </div>

                <div class="editor-row">
                    <span class="editor-label">字体粗细</span>
                    <select class="editor-select" id="system-font-weight" onchange="updateSystemConfig('fontWeight', this.value)">
                        <option value="normal" selected>正常</option>
                        <option value="bold">加粗</option>
                        <option value="300">细</option>
                        <option value="500">中等</option>
                    </select>
                </div>

                <div class="editor-row">
                    <span class="editor-label">字体URL</span>
                    <input type="text" class="editor-input" id="system-font-url" placeholder="字体文件URL"
                           onchange="applySystemFont(this.value)">
                </div>
                <div class="editor-row">
                    <span class="editor-label">上传字体</span>
                    <input type="file" class="editor-input" accept=".woff,.woff2,.ttf,.otf" onchange="handleSystemFontUpload(this)">
                </div>
            </div>
        </div>

        <!-- ====== 形状与圆角 ====== -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="5" ry="5"/></svg>
                    形状与圆角
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">圆角</span>
                    <input type="range" class="editor-slider" id="system-radius" min="0" max="30" value="0"
                           oninput="updateSystemConfig('radius', this.value); document.getElementById('system-radius-input').value=this.value">
                    <input type="number" class="editor-input" id="system-radius-input" value="0" min="0" max="30" style="width:60px;"
                           oninput="updateSystemConfig('radius', this.value); document.getElementById('system-radius').value=this.value"> px
                </div>

                <div class="editor-row">
                    <span class="editor-label">内边距(横)</span>
                    <input type="range" class="editor-slider" id="system-pad-x" min="0" max="30" value="0"
                           oninput="updateSystemConfig('padX', this.value); document.getElementById('system-pad-x-input').value=this.value">
                    <input type="number" class="editor-input" id="system-pad-x-input" value="0" min="0" max="30" style="width:60px;"
                           oninput="updateSystemConfig('padX', this.value); document.getElementById('system-pad-x').value=this.value"> px
                </div>

                <div class="editor-row">
                    <span class="editor-label">内边距(纵)</span>
                    <input type="range" class="editor-slider" id="system-pad-y" min="0" max="20" value="0"
                           oninput="updateSystemConfig('padY', this.value); document.getElementById('system-pad-y-input').value=this.value">
                    <input type="number" class="editor-input" id="system-pad-y-input" value="0" min="0" max="20" style="width:60px;"
                           oninput="updateSystemConfig('padY', this.value); document.getElementById('system-pad-y').value=this.value"> px
                </div>

                <!-- 边框 -->
                <div class="editor-row">
                    <span class="editor-label">边框粗细</span>
                    <input type="range" class="editor-slider" id="system-border-w" min="0" max="5" value="0"
                           oninput="updateSystemConfig('borderWidth', this.value); document.getElementById('system-border-w-input').value=this.value">
                    <input type="number" class="editor-input" id="system-border-w-input" value="0" min="0" max="5" style="width:60px;"
                           oninput="updateSystemConfig('borderWidth', this.value); document.getElementById('system-border-w').value=this.value"> px
                </div>
                <div id="system-border-color-picker"></div>

                <!-- 阴影 -->
                <div id="system-shadow-picker"></div>
            </div>
        </div>

    </div>
</div>

<div class="editor-content hidden" id="content-overall-chatarea">
    <div class="editor-group">
        
        <!-- ================= 聊天区域布局 ================= -->
<div class="collapse-section">
    <div class="collapse-header" onclick="toggleCollapse(this)">
        <span class="collapse-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/><line x1="9" y1="21" x2="9" y2="9"/></svg>
            聊天区域布局
        </span>
        <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
    </div>
    <div class="collapse-body">
        <!-- ===== 新增：整体缩放 ===== -->
        <div class="editor-row" style="margin-bottom: 16px; padding-bottom: 16px; border-bottom: 1px dashed var(--border-color);">
            <span class="editor-label" style="font-weight: 500;">整体比例</span>
            <input type="range" class="editor-slider" id="chat-area-scale-slider" min="30" max="150" value="100" 
                   oninput="updateChatAreaLayout('scale', null, this.value); this.nextElementSibling.value=this.value">
            <input type="number" class="editor-input" id="chat-area-scale-input" style="width:55px;" value="100" min="30" max="150"
                   oninput="updateChatAreaLayout('scale', null, this.value); this.previousElementSibling.value=this.value"> %
        </div>

        <!-- 内缩 (padding) -->
                <div class="four-sides-control">
                    <div class="four-sides-header">
                        <span>内缩 (padding)</span>
                    </div>
                    <div class="four-sides-individual show">
                        <div class="editor-row">
                            <span class="editor-label">上</span>
                            <input type="range" class="editor-slider" min="0" max="100" value="20" 
                                   oninput="updateChatAreaLayout('padding','t',this.value); this.nextElementSibling.value=this.value">
                            <input type="number" class="editor-input" style="width:50px" value="20" 
                                   oninput="updateChatAreaLayout('padding','t',this.value); this.previousElementSibling.value=this.value"> px
                        </div>
                        <div class="editor-row">
                            <span class="editor-label">下</span>
                            <input type="range" class="editor-slider" min="0" max="100" value="20" 
                                   oninput="updateChatAreaLayout('padding','b',this.value); this.nextElementSibling.value=this.value">
                            <input type="number" class="editor-input" style="width:50px" value="20" 
                                   oninput="updateChatAreaLayout('padding','b',this.value); this.previousElementSibling.value=this.value"> px
                        </div>
                        <div class="editor-row">
                            <span class="editor-label">左</span>
                            <input type="range" class="editor-slider" min="0" max="100" value="20" 
                                   oninput="updateChatAreaLayout('padding','l',this.value); this.nextElementSibling.value=this.value">
                            <input type="number" class="editor-input" style="width:50px" value="20" 
                                   oninput="updateChatAreaLayout('padding','l',this.value); this.previousElementSibling.value=this.value"> px
                        </div>
                        <div class="editor-row">
                            <span class="editor-label">右</span>
                            <input type="range" class="editor-slider" min="0" max="100" value="20" 
                                   oninput="updateChatAreaLayout('padding','r',this.value); this.nextElementSibling.value=this.value">
                            <input type="number" class="editor-input" style="width:50px" value="20" 
                                   oninput="updateChatAreaLayout('padding','r',this.value); this.previousElementSibling.value=this.value"> px
                        </div>
                    </div>
                </div>

                <!-- 位置移动 (margin) -->
                <div class="four-sides-control">
                    <div class="four-sides-header">
                        <span>位置移动 (margin)</span>
                    </div>
                    <div class="four-sides-individual show">
                        <div class="editor-row">
                            <span class="editor-label">上</span>
                            <input type="range" class="editor-slider" min="-100" max="100" value="0" 
                                   oninput="updateChatAreaLayout('margin','t',this.value); this.nextElementSibling.value=this.value">
                            <input type="number" class="editor-input" style="width:50px" value="0" 
                                   oninput="updateChatAreaLayout('margin','t',this.value); this.previousElementSibling.value=this.value"> px
                        </div>
                        
                        <div class="editor-row">
                            <span class="editor-label">下</span>
                            <input type="range" class="editor-slider" min="-100" max="100" value="0" 
                                   oninput="updateChatAreaLayout('margin','b',this.value); this.nextElementSibling.value=this.value">
                            <input type="number" class="editor-input" style="width:50px" value="0" 
                                   oninput="updateChatAreaLayout('margin','b',this.value); this.previousElementSibling.value=this.value"> px
                        </div>

                        <div class="editor-row">
                            <span class="editor-label">左</span>
                            <input type="range" class="editor-slider" min="-100" max="100" value="0" 
                                   oninput="updateChatAreaLayout('margin','l',this.value); this.nextElementSibling.value=this.value">
                            <input type="number" class="editor-input" style="width:50px" value="0" 
                                   oninput="updateChatAreaLayout('margin','l',this.value); this.previousElementSibling.value=this.value"> px
                        </div>

                        <div class="editor-row">
                            <span class="editor-label">右</span>
                            <input type="range" class="editor-slider" min="-100" max="100" value="0" 
                                   oninput="updateChatAreaLayout('margin','r',this.value); this.nextElementSibling.value=this.value">
                            <input type="number" class="editor-input" style="width:50px" value="0" 
                                   oninput="updateChatAreaLayout('margin','r',this.value); this.previousElementSibling.value=this.value"> px
                        </div>
                    </div>
                </div>
            </div> <!-- 这里的 div 关闭 collapse-body -->
        </div> <!-- 这里的 div 关闭 collapse-section (布局) -->

        <!-- ================= 聊天区域背景 (现在是独立的兄弟节点) ================= -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2z"/><line x1="1" y1="1" x2="23" y2="23"/></svg>
                    背景样式
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div id="chat-area-bg-picker"></div>
                <div class="editor-row">
                    <span class="editor-label">背景图URL</span>
                    <input type="text" class="editor-input" id="chat-area-bg-url" placeholder="输入背景图链接" onchange="styleConfig.chatArea.bgUrl = this.value; updatePreview();">
                </div>
                <div class="editor-row">
                    <span class="editor-label">上传背景</span>
                    <input type="file" class="editor-input" accept="image/*" onchange="handleChatAreaBgUpload(this)">
                </div>
            </div>
        </div>

    </div> <!-- 关闭 editor-group -->
</div> <!-- 关闭 content-overall-chatarea -->

<div class="editor-content hidden" id="content-overall-topbar">
    <div class="editor-group">
        <!-- 整体样式 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <!-- 修复：添加了布局图标 -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><line x1="3" y1="9" x2="21" y2="9"/></svg>
                    整体样式 (背景/尺寸)
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
    <div id="topbar-bg-picker"></div>
    
    <!-- 新增：顶栏背景图设置 -->
    <div class="editor-row">
        <span class="editor-label">背景图URL</span>
        <input type="text" class="editor-input" id="topbar-bg-url" placeholder="输入背景图链接" onchange="updateTopBar('container', 'bgUrl', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">上传背景</span>
        <input type="file" class="editor-input" accept="image/*" onchange="handleTopBarBgUpload(this)">
    </div>
    
    <div class="editor-row">
        <span class="editor-label">高度</span>
        <input type="range" class="editor-slider" min="40" max="100" value="60" 
               oninput="updateTopBar('container', 'height', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="60" style="width:50px;" 
               oninput="updateTopBar('container', 'height', this.value); this.previousElementSibling.value=this.value"> px
    </div>
    <div class="editor-row">
        <span class="editor-label">底部边框</span>
        <input type="text" class="editor-input" value="1px solid #e0e0e0" onchange="updateTopBar('container', 'border', this.value)">
    </div>
</div>
        </div>

        <!-- 返回按钮 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <!-- 修复：添加了返回箭头图标 -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="15 18 9 12 15 6"/></svg>
                    返回按钮 (左侧)
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">大小</span>
                    <input type="range" class="editor-slider" min="12" max="48" value="28" 
                           oninput="updateTopBar('backBtn', 'size', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="28" style="width:50px;" 
                           oninput="updateTopBar('backBtn', 'size', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">X 偏移</span>
                    <input type="range" class="editor-slider" min="-200" max="200" value="0" 
                           oninput="updateTopBar('backBtn', 'x', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateTopBar('backBtn', 'x', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y 偏移</span>
                    <input type="range" class="editor-slider" min="-200" max="200" value="0" 
                           oninput="updateTopBar('backBtn', 'y', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateTopBar('backBtn', 'y', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div id="topbar-back-color-picker"></div>
                <div class="editor-row">
                    <span class="editor-label">图标URL</span>
                    <input type="text" class="editor-input" placeholder="输入URL" onchange="updateTopBar('backBtn', 'url', this.value)">
                </div>
            </div>
        </div>

        <!-- 标题/备注 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <!-- 修复：添加了字体图标 -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 7V4h16v3"/><path d="M9 20h6"/><path d="M12 4v16"/></svg>
                    标题/备注
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">字体大小</span>
                    <input type="range" class="editor-slider" min="12" max="32" value="18" 
                           oninput="updateTopBar('title', 'size', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="18" style="width:50px;" 
                           oninput="updateTopBar('title', 'size', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">X 偏移</span>
                    <input type="range" class="editor-slider" min="-200" max="200" value="0" 
                           oninput="updateTopBar('title', 'x', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateTopBar('title', 'x', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y 偏移</span>
                    <input type="range" class="editor-slider" min="-200" max="200" value="0" 
                           oninput="updateTopBar('title', 'y', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateTopBar('title', 'y', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div id="topbar-title-color-picker"></div>
            </div>
        </div>

        <!-- 线下按钮 (新增) -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <!-- 修复：添加了门/退出图标 -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M18 6L6 12l12 6"/></svg>
                    线下按钮 (右侧左)
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">大小</span>
                    <input type="range" class="editor-slider" min="12" max="48" value="22" 
                           oninput="updateTopBar('offlineBtn', 'size', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="22" style="width:50px;" 
                           oninput="updateTopBar('offlineBtn', 'size', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">X 偏移</span>
                    <input type="range" class="editor-slider" min="-200" max="200" value="0" 
                           oninput="updateTopBar('offlineBtn', 'x', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateTopBar('offlineBtn', 'x', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y 偏移</span>
                    <input type="range" class="editor-slider" min="-200" max="200" value="0" 
                           oninput="updateTopBar('offlineBtn', 'y', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateTopBar('offlineBtn', 'y', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div id="topbar-offline-color-picker"></div>
                <div class="editor-row">
                    <span class="editor-label">图标URL</span>
                    <input type="text" class="editor-input" placeholder="输入URL" onchange="updateTopBar('offlineBtn', 'url', this.value)">
                </div>
                <div class="editor-row">
                    <span class="editor-label">上传图标</span>
                    <input type="file" class="editor-input" accept="image/*" onchange="handleTopBarIconUpload('offlineBtn', this)">
                </div>
            </div>
        </div>

        <!-- 更多按钮 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <!-- 修复：添加了更多菜单图标 -->
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="1"/><circle cx="12" cy="5" r="1"/><circle cx="12" cy="19" r="1"/></svg>
                    更多按钮 (右侧右)
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">大小</span>
                    <input type="range" class="editor-slider" min="12" max="48" value="22" 
                           oninput="updateTopBar('moreBtn', 'size', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="22" style="width:50px;" 
                           oninput="updateTopBar('moreBtn', 'size', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">X 偏移</span>
                    <input type="range" class="editor-slider" min="-200" max="200" value="0" 
                           oninput="updateTopBar('moreBtn', 'x', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateTopBar('moreBtn', 'x', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y 偏移</span>
                    <input type="range" class="editor-slider" min="-200" max="200" value="0" 
                           oninput="updateTopBar('moreBtn', 'y', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateTopBar('moreBtn', 'y', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div id="topbar-more-color-picker"></div>
                <div class="editor-row">
                    <span class="editor-label">图标URL</span>
                    <input type="text" class="editor-input" placeholder="输入URL" onchange="updateTopBar('moreBtn', 'url', this.value)">
                </div>
                <div class="editor-row">
                    <span class="editor-label">上传图标</span>
                    <input type="file" class="editor-input" accept="image/*" onchange="handleTopBarIconUpload('moreBtn', this)">
                </div>
            </div>
        </div>
    </div>
</div> <!-- 关键修复：补上了这个缺失的闭合标签，将顶栏和底栏区分开 -->

<div class="editor-content hidden" id="content-overall-bottombar">
    <div class="editor-group">
        <!-- 整体样式 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="16" width="20" height="6" rx="2"/><path d="M12 16v-6"/></svg>
                    整体样式 (背景)
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            
            <div class="collapse-body">
    <div class="editor-row">
        <span class="editor-label">底栏高度</span>
        <input type="range" class="editor-slider" min="40" max="120" value="50" 
               oninput="updateBottomBar('container', 'height', this.value); this.nextElementSibling.value=this.value">
        <input type="number" class="editor-input" value="50" style="width:50px;" 
               oninput="updateBottomBar('container', 'height', this.value); this.previousElementSibling.value=this.value"> px
    </div>

    <div id="bottombar-bg-picker"></div>
    
    <!-- 新增：底栏背景图设置 -->
    <div class="editor-row">
        <span class="editor-label">背景图URL</span>
        <input type="text" class="editor-input" id="bottombar-bg-url" placeholder="输入背景图链接" onchange="updateBottomBar('container', 'bgUrl', this.value)">
    </div>
    <div class="editor-row">
        <span class="editor-label">上传背景</span>
        <input type="file" class="editor-input" accept="image/*" onchange="handleBottomBarBgUpload(this)">
    </div>

    <div class="editor-row">
        <span class="editor-label">顶部边框</span>
        <input type="text" class="editor-input" value="1px solid #E0E0E0" onchange="updateBottomBar('container', 'border', this.value)">
    </div>
</div>
        </div>

        <!-- 菜单/工具按钮 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
                    左侧工具按钮 (+)
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <!-- 新增：图标大小 -->
                <div class="editor-row">
                    <span class="editor-label">图标大小</span>
                    <input type="range" class="editor-slider" min="10" max="40" value="28" 
                           oninput="updateBottomBar('toolBtn', 'size', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="28" style="width:50px;" 
                           oninput="updateBottomBar('toolBtn', 'size', this.value); this.previousElementSibling.value=this.value"> px
                </div>

                <div class="editor-row">
                    <span class="editor-label">X 偏移</span>
                    <input type="range" class="editor-slider" min="-50" max="50" value="0" 
                           oninput="updateBottomBar('toolBtn', 'x', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateBottomBar('toolBtn', 'x', this.value); this.previousElementSibling.value=this.value">
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y 偏移</span>
                    <input type="range" class="editor-slider" min="-20" max="20" value="0" 
                           oninput="updateBottomBar('toolBtn', 'y', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateBottomBar('toolBtn', 'y', this.value); this.previousElementSibling.value=this.value">
                </div>
                <div class="editor-row">
                    <span class="editor-label">宽度</span>
                    <input type="number" class="editor-input" value="28" oninput="updateBottomBar('toolBtn', 'width', this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">高度</span>
                    <input type="number" class="editor-input" value="28" oninput="updateBottomBar('toolBtn', 'height', this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">圆角</span>
                    <input type="range" class="editor-slider" min="0" max="50" value="50" 
                           oninput="updateBottomBar('toolBtn', 'radius', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="50" style="width:50px;" 
                           oninput="updateBottomBar('toolBtn', 'radius', this.value); this.previousElementSibling.value=this.value"> %
                </div>
                <div id="bottombar-tool-color-picker"></div>
                <div id="bottombar-tool-bg-picker"></div>

                <div class="editor-row">
                    <span class="editor-label">图标URL</span>
                    <input type="text" class="editor-input" onchange="updateBottomBar('toolBtn', 'url', this.value)">
                </div>
            </div>
        </div>

        <!-- 输入框 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"/></svg>
                    输入框
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-row">
                    <span class="editor-label">高度</span>
                    <input type="number" class="editor-input" value="36" oninput="updateBottomBar('input', 'height', this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">圆角</span>
                    <input type="range" class="editor-slider" min="0" max="24" value="8" 
                           oninput="updateBottomBar('input', 'radius', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="8" style="width:50px;" 
                           oninput="updateBottomBar('input', 'radius', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                
                <div id="bottombar-input-bg-picker"></div>
                
                <div class="editor-row">
                    <span class="editor-label">占位文字</span>
                    <input type="text" class="editor-input" value="输入消息..." oninput="updateBottomBar('input', 'placeholder', this.value)">
                </div>
                <div class="editor-row">
                    <span class="editor-label">边框宽</span>
                    <input type="range" class="editor-slider" min="0" max="5" value="0" 
                           oninput="updateBottomBar('input', 'borderWidth', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateBottomBar('input', 'borderWidth', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div id="bottombar-input-border-picker"></div>
            </div>
        </div>

        <!-- 续写/回复按钮 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/><line x1="9" y1="10" x2="15" y2="10"/></svg>
                    中间按钮 (续写)
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <!-- 新增：图标大小 -->
                <div class="editor-row">
                    <span class="editor-label">图标大小</span>
                    <input type="range" class="editor-slider" min="10" max="40" value="18" 
                           oninput="updateBottomBar('resumeBtn', 'size', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="18" style="width:50px;" 
                           oninput="updateBottomBar('resumeBtn', 'size', this.value); this.previousElementSibling.value=this.value"> px
                </div>

                <div class="editor-row">
                    <span class="editor-label">X 偏移</span>
                    <input type="range" class="editor-slider" min="-50" max="50" value="0" 
                           oninput="updateBottomBar('resumeBtn', 'x', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateBottomBar('resumeBtn', 'x', this.value); this.previousElementSibling.value=this.value">
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y 偏移</span>
                    <input type="range" class="editor-slider" min="-20" max="20" value="0" 
                           oninput="updateBottomBar('resumeBtn', 'y', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateBottomBar('resumeBtn', 'y', this.value); this.previousElementSibling.value=this.value">
                </div>
                <div id="bottombar-resume-color-picker"></div>
                <div id="bottombar-resume-bg-picker"></div>

                <div class="editor-row">
                    <span class="editor-label">图标URL</span>
                    <input type="text" class="editor-input" placeholder="图标URL" onchange="updateBottomBar('resumeBtn', 'url', this.value)">
                </div>
            </div>
        </div>

        <!-- 发送按钮 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="22" y1="2" x2="11" y2="13"/><polygon points="22 2 15 22 11 13 2 9 22 2"/></svg>
                    发送按钮
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <!-- 新增：字体大小 -->
                <div class="editor-row">
                    <span class="editor-label">字体大小</span>
                    <input type="range" class="editor-slider" min="10" max="24" value="14" 
                           oninput="updateBottomBar('sendBtn', 'size', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="14" style="width:50px;" 
                           oninput="updateBottomBar('sendBtn', 'size', this.value); this.previousElementSibling.value=this.value"> px
                </div>

                <div class="editor-row">
                    <span class="editor-label">按钮文字</span>
                    <input type="text" class="editor-input" id="send-btn-text-input" value="发送" oninput="updateBottomBar('sendBtn', 'text', this.value)">
                </div>
                <div class="editor-row">
                    <span class="editor-label">X 偏移</span>
                    <input type="range" class="editor-slider" min="-50" max="50" value="0" 
                           oninput="updateBottomBar('sendBtn', 'x', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateBottomBar('sendBtn', 'x', this.value); this.previousElementSibling.value=this.value">
                </div>
                <div class="editor-row">
                    <span class="editor-label">Y 偏移</span>
                    <input type="range" class="editor-slider" min="-20" max="20" value="0" 
                           oninput="updateBottomBar('sendBtn', 'y', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="0" style="width:50px;" 
                           oninput="updateBottomBar('sendBtn', 'y', this.value); this.previousElementSibling.value=this.value">
                </div>
                <div class="editor-row">
                    <span class="editor-label">宽度</span>
                    <input type="number" class="editor-input" value="50" oninput="updateBottomBar('sendBtn', 'width', this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">高度</span>
                    <input type="number" class="editor-input" value="30" oninput="updateBottomBar('sendBtn', 'height', this.value)"> px
                </div>
                <div class="editor-row">
                    <span class="editor-label">圆角</span>
                    <input type="range" class="editor-slider" min="0" max="30" value="25" 
                           oninput="updateBottomBar('sendBtn', 'radius', this.value); this.nextElementSibling.value=this.value">
                    <input type="number" class="editor-input" value="25" style="width:50px;" 
                           oninput="updateBottomBar('sendBtn', 'radius', this.value); this.previousElementSibling.value=this.value"> px
                </div>
                <div id="bottombar-send-bg-picker"></div>
                <div id="bottombar-send-text-picker"></div>
            </div>
        </div>
    </div>
</div>
            
<!-- 导出页面 -->
<div class="editor-content hidden" id="content-export-export">
    <div class="editor-group">
        <div class="editor-group-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
            导出代码
        </div>
        <button class="editor-btn primary" onclick="generateExportCode()" style="margin-bottom: 12px;">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
            生成代码
        </button>
        <textarea class="editor-textarea" id="exportCodeArea" rows="10" placeholder="点击上方按钮生成代码..."></textarea>
        <div class="editor-btn-row">
            <button class="editor-btn" onclick="copyToClipboard('exportCodeArea')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                复制到剪切板
            </button>
            <button class="editor-btn" onclick="exportToTxt('exportCodeArea')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                导出为txt
            </button>
            <button class="editor-btn" onclick="exportToDocx('exportCodeArea')">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                导出为docx
            </button>
        </div>
    </div>
</div>

<!-- 加密页面 -->
<div class="editor-content hidden" id="content-export-encrypt">
    <div class="editor-group">
        <div class="editor-group-title">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            加密代码
        </div>
        <textarea class="editor-textarea" id="encryptCodeArea" rows="8" readonly></textarea>
        
        <!-- 加密方式折叠栏 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"/></svg>
                    加密方式
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="encrypt-option">
                    <label class="editor-switch">
                        <input type="checkbox" id="opt-author-comment">
                        <span class="editor-switch-slider"></span>
                    </label>
                    <span class="encrypt-option-label">作者注释</span>
                    <input type="text" class="editor-input small" id="author-name" placeholder="作者名">
                </div>
                <div class="encrypt-option">
                    <label class="editor-switch">
                        <input type="checkbox" id="opt-random-comment">
                        <span class="editor-switch-slider"></span>
                    </label>
                    <span class="encrypt-option-label">随机插入自定义代码注释</span>
                    <input type="text" class="editor-input small" id="custom-comment" placeholder="注释内容">
                </div>
                <div class="encrypt-option">
                    <label class="editor-switch">
                        <input type="checkbox" id="opt-watermark">
                        <span class="editor-switch-slider"></span>
                    </label>
                    <span class="encrypt-option-label">随机插入自定义水印代码</span>
                    <input type="text" class="editor-input small" id="watermark-code" placeholder="水印代码">
                </div>
                <div class="encrypt-option">
                    <label class="editor-switch">
                        <input type="checkbox" id="opt-prefix-suffix">
                        <span class="editor-switch-slider"></span>
                    </label>
                    <span class="encrypt-option-label">更改无关要紧的前缀、后缀</span>
                </div>
                <div class="encrypt-option">
                    <label class="editor-switch">
                        <input type="checkbox" id="opt-chain">
                        <span class="editor-switch-slider"></span>
                    </label>
                    <span class="encrypt-option-label">链式混淆</span>
                </div>
                <div class="editor-row">
                    <span class="editor-label">混淆强度</span>
                    <select class="editor-select" id="encrypt-strength">
                        <option value="low">低</option>
                        <option value="medium" selected>中</option>
                        <option value="high">高</option>
                    </select>
                </div>
                <button class="editor-btn primary" onclick="generateEncrypted()">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></svg>
                    生成加密代码
                </button>
            </div>
        </div>
        
        <!-- 导出折叠栏 -->
        <div class="collapse-section">
            <div class="collapse-header" onclick="toggleCollapse(this)">
                <span class="collapse-title">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    导出
                </span>
                <svg class="collapse-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </div>
            <div class="collapse-body">
                <div class="editor-btn-row">
                    <button class="editor-btn" onclick="copyToClipboard('encryptCodeArea')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
                        复制到剪切板
                    </button>
                    <button class="editor-btn" onclick="exportToTxt('encryptCodeArea')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/></svg>
                        导出为txt
                    </button>
                    <button class="editor-btn" onclick="exportToDocx('encryptCodeArea')">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/></svg>
                        导出为docx
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="index.js"></script>
</body>
</html>